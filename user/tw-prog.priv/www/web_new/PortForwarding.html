<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3c.org/1999/xhtml"><head><title>D-LINK</title><meta http-equiv="cache-control" content="no-cache"><meta http-equiv="expires" content="0"><link rel="icon" href="/image/dlink-favicon.ico?v=1075792207"><link rel="shortcut icon" href="/image/favicon.ico?v=1075792207" type="image/x-icon"><meta http-equiv="X-UA-Compatible" content="IE=9"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Type" content="text/css"><link rel="stylesheet" type="text/css" href="/css/jquery.selectbox.css?v=1a58d5229c"><link rel="stylesheet" type="text/css" href="/css/jquery.checkbox.css?v=d4c74ef61d"><script type="text/javascript" charset="utf-8" src="/js/initialJQ.js?v=72051ca6ec"></script><script type="text/javascript" charset="utf-8" src="/js/initialJS.js?v=49978ee093"></script><script type="text/javascript" charset="utf-8" src="/js/initialCSS.js?v=668496d31b"></script><script type="text/javascript" charset="utf-8" src="/js/initialValidate.js?v=18ad6b1a1d"></script><script type="text/javascript" charset="utf-8" src="/js/PortForwarding.js?v=9109dc3ace"></script><link rel="stylesheet" type="text/css" href="css/style_pop.css?v=ebdc1ea095" media="all"><script type="text/javascript" charset="utf-8" src="/js/popView.js?v=28d8d08a05"></script><script type="text/javascript">top!=self&&(top.location=self.location),null===sessionStorage.getItem("PrivateKey")&&window.location.replace("../info/Login.html");var datalist,lanIP,submask,HNAP=new HNAP_XML,Total_ScheduleRules=0,Limit_TotalPortForwardingRules=24,Total_Client=0,Limit_Client=256;function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu(),initialDetectRouterConnection(),datalist=new Datalist}function GetXML(){HNAP.GetXMLAsync("GetMultipleHNAPs",null,"GetXML",function(e){GetResult_1st(e)})}function GetResult_1st(e){null!=e?(currentDevice.featureBitMapSchedule?e.Set("GetMultipleHNAPs/GetScheduleBitmapSettings"):e.Set("GetMultipleHNAPs/GetScheduleSettings"),e.Set("GetMultipleHNAPs/GetClientInfo"),e.Set("GetMultipleHNAPs/GetPortForwardingSettings"),e.Set("GetMultipleHNAPs/GetRouterLanSettings"),HNAP.SetXMLAsync("GetMultipleHNAPs",e,function(e){GetResult_2nd(e)})):1==DebugMode&&alert("[!!GetXML Error!!] Function: GetResult_1st")}function GetResult_2nd(e){lanIP=e.Get("GetMultipleHNAPsResponse/GetRouterLanSettingsResponse/RouterIPAddress"),submask=e.Get("GetMultipleHNAPsResponse/GetRouterLanSettingsResponse/RouterSubnetMask");var t=e.Get("GetMultipleHNAPsResponse/GetMultipleHNAPsResult");if("OK"==t||"RESTART"==t){var n;n=currentDevice.featureBitMapSchedule?e.Get("GetMultipleHNAPsResponse/GetScheduleBitmapSettingsResponse/ScheduleBitmapLists#"):e.Get("GetMultipleHNAPsResponse/GetScheduleSettingsResponse/ScheduleInfoLists#"),Total_ScheduleRules=n;document.getElementById("pf_Schedule");$("#pf_Schedule").append('<option value="Always">'+I18N("j","Always")+"</option>");for(var o=1;o<=Total_ScheduleRules;o++){var i="";"H24-UH1xLTJa7O"!=(i=currentDevice.featureBitMapSchedule?e.Get("GetMultipleHNAPsResponse/GetScheduleBitmapSettingsResponse/ScheduleBitmapLists:"+o+"/ScheduleName"):e.Get("GetMultipleHNAPsResponse/GetScheduleSettingsResponse/ScheduleInfoLists:"+o+"/ScheduleName"))&&"H5-UH1xLTJa7O"!=i&&"H52-UH1xLTJa7O"!=i&&"G24-UH1xLTJa7O"!=i&&"G5-UH1xLTJa7O"!=i&&"G52-UH1xLTJa7O"!=i&&$("#pf_Schedule").append('<option value="'+i+'">'+AllEncode(decode_char_text(i))+"</option>")}Total_Client=e.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo#");for(var l=document.getElementById("select_pf_LocalIP"),a=1,s=1;s<=Total_Client;s++){var r=e.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo:"+s+"/DeviceName"),d=e.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo:"+s+"/IPv4Address");0<=e.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo:"+s+"/Type").indexOf("Extender")||(""==r&&(r="Unknown"),""!=d&&(l.options.add(new Option(d+" ("+r+")",a)),a++))}for(var u=e.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo#"),c=1;c<=u;c++){var p=e.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+c+"/Enabled"),P=e.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+c+"/PortForwardingDescription"),g=e.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+c+"/LocalIPAddress"),f=e.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+c+"/TCPPorts"),S=e.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+c+"/UDPPorts"),_=e.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+c+"/ScheduleName"),R=new Data(decode_char_text(P),g,f,S,_);R.setEnable(p),datalist.push(R)}check_TotalRule(Limit_TotalPortForwardingRules,datalist.length()),$("#select_pf_LocalIP").selectbox(),$("#pf_Schedule").selectbox(),document.getElementById("main").style.display="inline",$("select").change(function(){save_button_changed()}),$("input").keydown(function(){save_button_changed()}),$("input").change(function(){save_button_changed()})}else 1==DebugMode&&alert("[!!GetXML Error!!] Function: GetResult_2nd")}function CheckConnectionStatus(){$.ajax({cache:!1,url:"./js/CheckConnection",timeout:5e3,type:"GET",success:function(e){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){var e=I18N("j","Please wait")+" ...";PopView.show(e),HNAP.GetXMLAsync("SetPortForwardingSettings",null,"GetXML",function(e){SetResult_1st(e)})}function SetResult_1st(e){if(null!=e){for(var t=0;t<datalist.length();t++)e.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(t+1)+"/Enabled",datalist.list[t].enable),e.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(t+1)+"/PortForwardingDescription",encode_char_text(datalist.list[t].name)),e.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(t+1)+"/LocalIPAddress",datalist.list[t].ipAddress),e.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(t+1)+"/TCPPorts",datalist.list[t].tcpPort),e.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(t+1)+"/UDPPorts",datalist.list[t].udpPort),e.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(t+1)+"/ScheduleName",datalist.list[t].schedule);HNAP.SetXMLAsync("SetPortForwardingSettings",e,function(e){SetResult_2nd(e)})}}function SetResult_2nd(e){var t=e.Get("SetPortForwardingSettingsResponse/SetPortForwardingSettingsResult");"OK"==t||"RESTART"==t?Start_reciprocal_Number_RestoreConfiguration(!1):"REBOOT"==t?Start_reciprocal_Number_RestoreConfiguration(!0):location.reload()}function Start_reciprocal_Number_RestoreConfiguration(e){var t=I18N("j","Please wait")+" ...",n=I18N("j","The new settings have been saved."),o=currentDevice.okcount,i=new SOAPAction;1==e&&(t=I18N("j","Your changes are being saved, and the device will need to reboot."),o=currentDevice.rebootcount,i.sendSOAPAction("Reboot",null,null)),PopView.showWithCountdown(t,o).always(function(){PopView.showConfirm(n).done(function(){location.reload()})})}function waitSettingFinished(){window.location.reload()}function createUserButton(){changeTimeoutAction(),$("#popTitle").html(I18N("j","Create New Rule")),document.getElementById("createPop").style.display="inline",document.getElementById("createButton").disabled=!0,$("#portforwarding_form").val(-1)}function closeCreateRulePOP(e){changeTimeoutAction();var t=$("#pf_Name").val(),n=$("#pf_LocalIP").val(),o=$("#pf_TCPPort").val(),i=$("#pf_UDPPort").val(),l=$("#pf_Schedule").val(),a=new Data(t,n,o,i,l);(e<0?datalist.push(a):datalist.editData(e,a))&&(resetRulePOP(),check_TotalRule(Limit_TotalPortForwardingRules,datalist.length()))}function clearCreateRulePOP(){changeTimeoutAction(),resetRulePOP(),$("#portforwarding_form").validate().resetForm(),$(":text").prop("className","styled-text"),check_TotalRule(Limit_TotalPortForwardingRules,datalist.length())}function resetRulePOP(){document.getElementById("createPop").style.display="none",$("select").selectbox("detach"),$("input").val(""),$("#select_pf_LocalIP").val("0"),$("#pf_Schedule").val("Always"),$("select").selectbox("attach")}function editData(e){changeTimeoutAction(),$("#popTitle").html(I18N("j","Edit Rule")),document.getElementById("createPop").style.display="inline",document.getElementById("createButton").disabled=!0,$("#portforwarding_form").val(e);var t=datalist.getData(e);document.getElementById("pf_Name").value=t.name,document.getElementById("pf_LocalIP").value=t.ipAddress,document.getElementById("pf_TCPPort").value=t.tcpPort,document.getElementById("pf_UDPPort").value=t.udpPort,$("#pf_Schedule").selectbox("detach"),$("#pf_Schedule").val(t.schedule),$("#pf_Schedule").selectbox("attach")}function deleteData(e){changeTimeoutAction(),datalist.deleteData(e),check_TotalRule(Limit_TotalPortForwardingRules,datalist.length()),save_button_changed()}function pf_LocalIP_Description(e,t){var n=e.options[t].text.split("(")[0].replace(/\s/g,"");document.getElementById("pf_LocalIP").value="0"==t?"":n,$("#pf_LocalIP").valid()}function focusToFirstIndex(e){"save_buttonFocus"==e.id&&9==window.event.keyCode&&document.getElementById("pf_Name").focus()}function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none",document.getElementById("Save_btn").style.display="block",changeFlag=!0,changeTimeoutAction()}function check_TotalRule(e,t){var n=e-t;0==(document.getElementById("RemainingRules").innerHTML=n)?$("#createButton").attr("class","styled_button_dis").prop("disabled",!0):$("#createButton").attr("class","styled_button_s").prop("disabled",!1)}function CheckString(e,t){e.value=e.value.replace(/\s/g,"")}$(document).ready(function(){Load_HTML(),Initial(),setMenu("menu_Advanced"),GetXML(),startTimeout()})</script></head><body><div id="wrapper"><div id="header"></div><div id="menu"></div><div id="menu_edge"></div><div id="content"><div id="info"><div id="FunctionName"><script>I18N("h","Port Forwarding")</script></div><div id="wallimage"><img src="image/page_PortForwarding.png?v=196d26f006" alt="" width="195" height="119"></div><div id="directions"><script>I18N("h","Your router helps share a single IP address assigned by your ISP among several clients in your home. Port forwarding allows traffic requests from a specified application to be directed to a specified client inside.")</script></div></div><div id="funcBar"><div id="pagePath"><script>I18N("h","Advanced")</script>&gt;&gt;<script>I18N("h","Port Forwarding")</script></div><ul id="rightFunc"><li style="display:block"><div id="Save_btn" onclick="CheckConnectionStatus(),changeTimeoutAction()" style="cursor:pointer;display:none"><script>I18N("h","Save")</script></div></li><li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save")</script></div></li><li style="display:block"><a href="javascript:CheckHTMLStatus('VirtualServer');" style="text-decoration:none" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","Virtual Server")</script></div></a></li></ul></div><div id="main" style="display:none"><table class="mainTable" border="0" cellspacing="0" id="tblPortForwarding"><thead><tr><th><script>I18N("h","Status")</script></th><th><script>I18N("h","Name")</script></th><th><script>I18N("h","Local IP")</script></th><th><script>I18N("h","TCP Port")</script></th><th><script>I18N("h","UDP Port")</script></th><th><script>I18N("h","Schedule")</script></th><th><script>I18N("h","Edit")</script></th><th><script>I18N("h","Delete")</script></th></tr></thead><tbody></tbody></table><br><br><button type="button" id="createButton" name="createButton" class="styled_button_s" onclick="createUserButton()"><script>I18N("h","Add Rule")</script></button> &nbsp;&nbsp;<script>I18N("h","Remaining")</script>:&nbsp;<label id="RemainingRules">10</label><br><form name="portforwarding_form" id="portforwarding_form" action=""><input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"><div id="createPop" style="display:none"><div class="dialogBox" style="width:616px"><div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div><table class="myCreatePop_table" border="0" cellspacing="0" id="tblPortForwarding3"><tbody><tr><td colspan="3"><div class="popTitle" id="popTitle"></div></td></tr><tr><th><script>I18N("h","Name")</script>:</th><td valign="top" colspan="2"><input class="styled-text" type="text" name="pf_Name" size="27" id="pf_Name" maxlength="20" tabindex="1"></td></tr><tr><th><script>I18N("h","Local IP")</script>:</th><td valign="top" width="20px"><input class="styled-text" type="text" name="pf_LocalIP" size="27" id="pf_LocalIP" tabindex="2"></td><td valign="top"><div class="styled-select"><select style="width:150px" name="select_pf_LocalIP" id="select_pf_LocalIP" onchange="pf_LocalIP_Description(this,this.value)"><option value="0" selected="selected">&lt;&lt; Computer Name</option></select></div></td></tr><tr><th><script>I18N("h","TCP Port")</script>:</th><td valign="top" width="20px"><input class="styled-text" type="text" name="pf_TCPPort" size="27" id="pf_TCPPort" tabindex="3"></td><td>&nbsp;</td></tr><tr><th><script>I18N("h","UDP Port")</script>:</th><td valign="top" width="20px"><input class="styled-text" type="text" name="pf_UDPPort" size="27" id="pf_UDPPort" tabindex="4"></td><td>&nbsp;</td></tr><tr><th class="linkstyle_1"><a href="Schedule.html"><script>I18N("h","Schedule")</script></a>:</th><td width="20px"><div class="styled-select" tabindex="5"><select style="width:120px" name="pf_Schedule" id="pf_Schedule"></select></div></td><td>&nbsp;</td></tr><tr><td id="save_td" colspan="4"><center><button type="button" class="styled_button_s" id="save_buttonFocus" tabindex="6" onkeyup="focusToFirstIndex(this)" onclick='document.getElementById("sumbit_CheckData").click()'><script>I18N("h","Apply")</script></button></center></td></tr></tbody></table></div></div></form><div id="CreatePopAlertMessage" style="display:none"><div id="AlertPopRect"><div id="AlertPopBody"><table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"><tbody><tr><td><center><div id="Loading_pop_image2"></div></center></td></tr><tr><td><label id="reciprocal_Number"></label></td></tr><tr><td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.")</script></td></tr></tbody></table></div></div></div><div id="DetectRouterConnection" style="display:none"></div></div><div id="footer"><div id="copyright"><script>I18N("h","COPYRIGHT")</script></div></div></div></div><div id="popalert" class="black_overlay" style="display:none"><div class="popup_window_border" style="position:relative;top:15%"><div class="popup_window"><div id="popalert_circle"><img src="image/loading.gif?v=082200f467" width="62px" height="62px"></div><div id="popalert_countdown"></div><div id="popalert_title" style="display:none"></div><div id="popalert_InformationIMG" style="display:none"></div><div id="popalert_desc"></div><div id="popalert_buttons" class="btn-group" role="group" aria-label="..."><button type="button" id="popalert_ok" class="btn btn-default"><script>I18N("h","OK")</script></button> <button type="button" id="popalert_cancel" class="btn btn-default"><script>I18N("h","Cancel")</script></button></div></div></div></div><script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkALLNULL",function(e,r,a){var t=!0;return""==$(r).val()&&""==$(a).val()&&(t=!1),this.showMessage(a,"checkALLNULL",t),t},jQuery.validator.messages.port),$.validator.addMethod("checkPortRange",function(e,r){var a,t=e.replace(/\s/g,"").split(","),d=/(^\d{1,})+$/,s=/(^\d{1,}-\d{1,})$/;if(""==e)return!0;for(var o=0;o<t.length;o++)if(-1<t[o].search("-")){if(!s.test(t[o]))return!1;a=t[o].split("-");var n=parseInt(a[0],10),c=parseInt(a[1],10);if(65535<n||n<=0||65535<c||c<=0)return!1;if(c<n)return!1}else{if(!d.test(t[o]))return!1;if(65535<parseInt(t[o],10)||parseInt(t[o],10)<=0)return!1}return!0},jQuery.validator.messages.port_Check),$.validator.addMethod("checkIPFormat",function(e,r){return!!/(^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))+$/.test(e)},jQuery.validator.messages.address_Check),$.validator.addMethod("checkIPAddress",function(e,r){var a=COMM_IPv4MASK2INT(submask);return lanIP!=e&&!!(COMM_ValidV4Format(e)&&COMM_ValidV4Addr(e)&&COMM_ValidV4HOST(e,a)&&COMM_IPv4NETWORK(e,a)==COMM_IPv4NETWORK(lanIP,a))},jQuery.validator.messages.address_Check),$.validator.addMethod("checkRequired",function(e,r){return""!=e},I18N("j","Please enter a name for this rule.")),$.validator.addMethod("trimWhiteSpace",function(e,r){var a=!0;return e!=e.trim()&&(a=!1),a},I18N("j","Invalid %s. Only A-Z, a-z, 0-9, “-”, “_”, and spaces are allowed.",I18N("j","Name"))),$.validator.addMethod("checkGenName",function(e,r){var a=!0;return""!=e&&(a=COMM_ValidName(e)),a},I18N("j","Invalid %s. Only A-Z, a-z, 0-9, “-”, “_”, and spaces are allowed.",I18N("j","Name"))),$("#portforwarding_form").each(function(e,r){$(r).validate({rules:{pf_Name:{checkRequired:!0,trimWhiteSpace:!0,checkGenName:!0},pf_LocalIP:{required:!0,checkIPFormat:!0,checkIPAddress:!0},pf_TCPPort:{checkALLNULL:$("#pf_UDPPort"),checkPortRange:!0},pf_UDPPort:{checkALLNULL:$("#pf_TCPPort"),checkPortRange:!0}},messages:{pf_TCPPort:{required:jQuery.validator.messages.port},pf_UDPPort:{required:jQuery.validator.messages.port}},submitHandler:function(e){var r=e.value;closeCreateRulePOP(r)},debug:!0})})})</script></body></html><!-- svn info: $Revision: 1370 $ $Date: 2019-04-11 15:26:33 +0800 (Thu, 11 Apr 2019) $ --> 
