<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3c.org/1999/xhtml"><head><title>D-LINK</title><meta http-equiv="cache-control" content="no-cache"><meta http-equiv="expires" content="0"><link rel="icon" href="/image/dlink-favicon.ico?v=1075792207"><link rel="shortcut icon" href="/image/favicon.ico?v=1075792207" type="image/x-icon"><meta http-equiv="X-UA-Compatible" content="IE=9"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Type" content="text/css"><link rel="stylesheet" type="text/css" href="/css/jquery.selectbox.css?v=1a58d5229c"><link rel="stylesheet" type="text/css" href="/css/jquery.checkbox.css?v=d4c74ef61d"><script type="text/javascript" charset="utf-8" src="/js/initialJQ.js?v=72051ca6ec"></script><script type="text/javascript" charset="utf-8" src="/js/initialJS.js?v=49978ee093"></script><script type="text/javascript" charset="utf-8" src="/js/initialCSS.js?v=668496d31b"></script><script type="text/javascript" charset="utf-8" src="/js/initialValidate.js?v=18ad6b1a1d"></script><script type="text/javascript" charset="utf-8" src="/js/UserDevice_CreateUser.js?v=b21d41761b"></script><script type="text/javascript" charset="utf-8" src="/js/SOAP/SOAPUser.js?v=bf6e646001"></script><link rel="stylesheet" type="text/css" href="css/style_pop.css?v=ebdc1ea095" media="all"><script type="text/javascript" charset="utf-8" src="/js/popView.js?v=28d8d08a05"></script><style>body{position:relative}#createPop{display:none;position:absolute;z-index:500;left:0;top:0;width:100%;height:200%}#editPop{display:none;position:absolute;z-index:500;left:0;top:0;width:100%;height:200%}.progressBar{background-color:#fff;height:30px;width:300px;border:1px solid #4598aa;color:#222}.progressBar .bar{background-color:#4598aa;height:30px;width:0}</style><script type="text/javascript">top!=self&&(top.location=self.location),null===sessionStorage.getItem("PrivateKey")&&window.location.replace("../info/Login.html");var set_Iteration,HNAP=new HNAP_XML,counter=1,counter2=1,Total_User=0,Limit_TotalUser=10,IsOpenFolder=0,IsOpenFolder2=0,Name_CheckList=[],DefaultDirectory_Path="",DefaultDirectory_Name="",DefaultDirectory_RootN="",DefaultDirectory_RootP="",userList=new Array,delUserList=new Array,clickmode="add";function Load_HTML(){$("#header").load("header.html"),currentDevice.featureFTPServer&&currentDevice.featureUsbPort||$("#FTP_userList, #FTP_Dialog, #FTP_Dialog2").hide(),currentDevice.featureUsbPort||$("#SAMBA_userList, #SAMBA_Dialog, #SAMBA_Dialog2").hide()}function Initial(){initialMenu(),initialDetectRouterConnection()}function setIteration(e){set_Iteration=e}function createUserButton(){changeTimeoutAction(),document.getElementById("status_SAMBA").checked=!0,document.getElementById("status_FTP").checked=!1,document.getElementById("status_VPN").checked=!1,document.getElementById("SAMBA_Folder").value=I18N("j","root"),document.getElementById("FTP_Folder").value=I18N("j","root"),document.getElementById("createPop").style.display="block",document.getElementById("createButton").disabled=!0,$("#SAMBA_Permission").selectbox("detach"),$("#SAMBA_Permission").val("1"),$("#SAMBA_Permission").selectbox("attach"),$("#SAMBA_Permission").selectbox("enable"),$("#FTP_Permission").selectbox("detach"),$("#FTP_Permission").val("1"),$("#FTP_Permission").selectbox("attach"),$("#FTP_Permission").selectbox("disable"),document.getElementById("SAMBA_Folder").disabled=!1,document.getElementById("FTP_Folder").disabled=!0,document.getElementById("searchFolderSAMBA").disabled=!1,document.getElementById("searchFolderFTP").disabled=!0}function closeCreateUserPOP(){changeTimeoutAction(),"Success"==AddRowToIndex()&&(document.getElementById("status_SAMBA").checked=!0,document.getElementById("status_FTP").checked=!1,document.getElementById("status_VPN").checked=!1,document.getElementById("createPop").style.display="none",document.getElementById("createButton").disabled=!1,$("#SAMBA_Permission").selectbox("detach"),$("#SAMBA_Permission").val("1"),$("#SAMBA_Permission").selectbox("attach"),$("#FTP_Permission").selectbox("detach"),$("#FTP_Permission").val("1"),$("#FTP_Permission").selectbox("attach"),check_TotalUser(Limit_TotalUser,Total_User))}function clearCreateRulePOP(){changeTimeoutAction(),document.getElementById("status_SAMBA").checked=!0,document.getElementById("status_FTP").checked=!1,document.getElementById("status_VPN").checked=!1,document.getElementById("createPop").style.display="none",document.getElementById("createButton").disabled=!1,document.getElementById("shareport_UserName").value="",document.getElementById("shareport_Password").value="",$("#SAMBA_Permission").selectbox("detach"),$("#SAMBA_Permission").val("1"),$("#SAMBA_Permission").selectbox("attach"),$("#SAMBA_Permission").selectbox("enable"),$("#FTP_Permission").selectbox("detach"),$("#FTP_Permission").val("1"),$("#FTP_Permission").selectbox("attach"),$("#FTP_Permission").selectbox("disable"),document.getElementById("SAMBA_Folder").value=I18N("j","root"),$("#user_c1_form").validate().resetForm(),document.getElementById("FTP_Folder").value=I18N("j","root")}function editData(e){changeTimeoutAction(),document.getElementById("editPop").style.display="block",document.getElementById("createButton").disabled=!0,editDataGet(e)}function downloadData(e){changeTimeoutAction();var t="dlquickvpnsettings.cgi?username="+e;currentDevice.featureAddHNAP1Cgi&&(t="/HNAP1/dlquickvpnsettings.cgi?username="+e),currentDevice.featureCgiMethodGET&&(document.forms.dlquickvpnsettings.method="GET"),document.forms.dlquickvpnsettings.action=t,document.forms.dlquickvpnsettings.submit()}function closeEditUserPOP(e){changeTimeoutAction();var t=assignRowToIndex(e);"Success"==t?(document.getElementById("editPop").style.display="none",document.getElementById("createButton").disabled=!1):"Error"==t?alert("Name cannot be the same."):"NameNull"==t?alert("Name cannot be null."):document.getElementById("editPop").style.display="none"}function clearEditRulePOP(){changeTimeoutAction(),document.getElementById("editPop").style.display="none",document.getElementById("createButton").disabled=!1,$("#user_c2_form").validate().resetForm()}function closeTreeViewPOP(){"add"==clickmode?document.getElementById("createPop").style.display="block":document.getElementById("editPop").style.display="block",document.getElementById("treeViewPop").style.display="none",document.getElementById("partitionView").innerHTML="",document.getElementById("FolderTreeView").innerHTML=""}function closeTreeView2POP(){document.getElementById("editPop").style.display="block",document.getElementById("treeViewPop2").style.display="none",document.getElementById("partitionView2").innerHTML="",document.getElementById("FolderTreeView2").innerHTML=""}function GetEditDirectoryList(){var e=HNAP.GetXML("GetListDirectory"),t=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#"),n=document.getElementById("partitionView2"),o=document.getElementById("FolderTreeView2"),r="";if(n.innerHTML="",o.innerHTML="",document.getElementById("editPop").style.display="none",document.getElementById("treeViewPop2").style.display="inline",1<t){for(var i=1;i<=t;i++){r='<li><a href="javascript:GetDirectory_EditPartition('+i+')" id="editpartition_'+i+'" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>',n.innerHTML+=r,d=(d=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+i+"/DirectoryName")).replace(":",""),document.getElementById("editpartition_"+i).innerHTML=d}e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");GetDirectory_EditPartition(1)}else{r='<li><a href="javascript:GetDirectory_EditPartition(1)" id="editpartition_1" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>',n.innerHTML+=r;var d=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryName");e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");d=d.replace(":",""),document.getElementById("editpartition_1").innerHTML=d,GetDirectory_EditPartition(1)}}function GetEditSubFolderList(e){if(0==IsOpenFolder){var t=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",e)),n=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#"),o=document.getElementById("FolderTreeView2"),r=1;o.innerHTML+="<br />";for(var i=0;i<n;i++){var d=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+r+"/DirectoryName"),s=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+r+"/DirectoryPath"),l=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+r+"/SubDirectory"),c=d;o.innerHTML+="true"==l?"<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList2('+counter+');"><img src="image/folder_open.png?v=2c0ebed2b2" border="0"><a href="javascript:Return_Back2('+counter+');">'+c+"</a><label></label><label></label><label></label></div>":"<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList2('+counter+');"><a href="javascript:Return_Back2('+counter+');">'+c+"</a><label></label><label></label><label></label></div>",document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=s,document.getElementById("subfolder_"+counter).childNodes[3].style.display="none",document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=l,document.getElementById("subfolder_"+counter).childNodes[4].style.display="none",document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=0,document.getElementById("subfolder_"+counter).childNodes[5].style.display="none",counter++,r++}IsOpenFolder=1}}function Get_SubFolderList2(e){if(0==document.getElementById("subfolder_"+e).childNodes[5].innerHTML){if("true"==document.getElementById("subfolder_"+e).childNodes[4].innerHTML){document.getElementById("subfolder_"+e).childNodes[5].innerHTML=1;var t=document.getElementById("subfolder_"+e).childNodes[3].innerHTML,n=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",t)),o=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#"),r=1,i=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+r+"/SubDirectory");document.getElementById("subfolder_"+e).childNodes[1].childNodes[0].src="./image/folder_close.png?v=ed04e0d8c1";for(var d=document.getElementById("subfolder_"+e),s=0;s<o;s++){var l=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+r+"/DirectoryName"),c=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+r+"/DirectoryPath"),a=(i=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+r+"/SubDirectory"),0),u={trueFolderName:l},m=c.match(/\//g),y="";y+="<div id=subfolder_"+counter+">";for(var b=1;b<m.length;b++)y+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";y+="true"==i?'<a href="javascript:Get_SubFolderList2('+counter+');"><img src="image/folder_open.png?v=2c0ebed2b2" border="0"><a href="javascript:Return_Back2('+counter+');"></a><label></label><label></label><label></label></div>':'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList2('+counter+');"><a href="javascript:Return_Back2('+counter+');"></a><label></label><label></label><label></label></div>',d.innerHTML+=y,document.getElementById("subfolder_"+counter).childNodes[2].innerHTML=u.trueFolderName,document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=c,document.getElementById("subfolder_"+counter).childNodes[3].style.display="none",document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=i,document.getElementById("subfolder_"+counter).childNodes[4].style.display="none",document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=a,document.getElementById("subfolder_"+counter).childNodes[5].style.display="none",counter++,r++}}else document.getElementById("subfolder_"+e).childNodes[1].childNodes[0].src="/image/folder_close.png?v=ed04e0d8c1"}else{i=document.getElementById("subfolder_"+e).childNodes[4].innerHTML,c=document.getElementById("subfolder_"+e).childNodes[3].innerHTML,t=document.getElementById("subfolder_"+e).childNodes[2].innerHTML;var p=document.getElementById("subfolder_"+e);for(u={trueFolderName:t},m=c.match(/\//g),y="",b=1;b<m.length;b++)y+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";p.innerHTML=y+'<a href="javascript:Get_SubFolderList2('+e+');" id=subfolder_'+e+'><img src="image/folder_open.png?v=2c0ebed2b2" border="0"></a><a href="javascript:Return_Back2('+e+');"></a><label></label><label></label><label></label></div>';a=0;document.getElementById("subfolder_"+e).childNodes[2].innerHTML=u.trueFolderName,document.getElementById("subfolder_"+e).childNodes[3].innerHTML=c,document.getElementById("subfolder_"+e).childNodes[3].style.display="none",document.getElementById("subfolder_"+e).childNodes[4].innerHTML=i,document.getElementById("subfolder_"+e).childNodes[4].style.display="none",document.getElementById("subfolder_"+e).childNodes[5].innerHTML=a,document.getElementById("subfolder_"+e).childNodes[5].style.display="none"}}function GetDirectoryList(e,t){clickmode=e;var n=HNAP.GetXML("GetListDirectory"),o=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#"),r=document.getElementById("partitionView"),i=document.getElementById("FolderTreeView"),d="";if(r.innerHTML="",i.innerHTML="","add"==clickmode?document.getElementById("createPop").style.display="none":document.getElementById("editPop").style.display="none",document.getElementById("treeViewPop").style.display="inline",1<o){for(var s=1;s<=o;s++){d='<li><a href="javascript:GetDirectory_Partition('+s+", '"+e+"', '"+t+'\')" id="partition_'+s+'" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>',r.innerHTML+=d,l=(l=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+s+"/DirectoryName")).replace(":",""),document.getElementById("partition_"+s).innerHTML=l}n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");GetDirectory_Partition(1,e,t)}else{d="<li><a href=\"javascript:GetDirectory_Partition(1, '"+e+"', '"+t+'\')" id="partition_1" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>',r.innerHTML+=d;var l=n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryName");n.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");l=l.replace(":",""),document.getElementById("partition_1").innerHTML=l,GetDirectory_Partition(1,e,t)}}function GetDirectory_Partition(e,t,n){document.getElementById("FolderTreeView").innerHTML="",setTimeout("GetDirectory_Partition_Append("+e+", '"+t+"', '"+n+"')",100)}function GetDirectory_Partition_Append(e,t,n){var o=HNAP.GetXML("GetListDirectory").Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+e+"/DirectoryPath");document.getElementById("FolderTreeView").innerHTML+="<a href=\"javascript:ReturnBack('"+t+"', '"+n+'\');" id="rootName" style="margin: 0 0 0 10px;"></a>',document.getElementById("rootName").innerHTML=o,IsOpenFolder=0,GetSubFolderList(o,t,n)}function GetDirectory_EditPartition(e){document.getElementById("FolderTreeView2").innerHTML="",setTimeout("GetDirectory_EditPartition_Append("+e+")",100)}function GetDirectory_EditPartition_Append(e){var t=HNAP.GetXML("GetListDirectory").Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+e+"/DirectoryPath");document.getElementById("FolderTreeView2").innerHTML+='<a href="javascript:ReturnBack2();" id="rootName2" style="margin: 0 0 0 10px;"></a>',document.getElementById("rootName2").innerHTML=t,IsOpenFolder=0,GetEditSubFolderList(t)}function Get_SubFolderList(e,t,n){if(0==document.getElementById("subfolder_"+e).childNodes[5].innerHTML){if("true"==document.getElementById("subfolder_"+e).childNodes[4].innerHTML){document.getElementById("subfolder_"+e).childNodes[5].innerHTML=1;var o=document.getElementById("subfolder_"+e).childNodes[3].innerHTML,r=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",o)),i=r.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#"),d=1,s=r.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/SubDirectory");document.getElementById("subfolder_"+e).childNodes[1].childNodes[0].src="./image/folder_close.png?v=ed04e0d8c1";for(var l=document.getElementById("subfolder_"+e),c=0;c<i;c++){var a=r.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryName"),u=r.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryPath"),m=(s=r.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/SubDirectory"),0),y={trueFolderName:a},b=u.match(/\//g),p="";p+="<div id=subfolder_"+counter+">";for(var g=1;g<b.length-1;g++)p+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";p+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",p+="true"==s?'<a href="javascript:Get_SubFolderList('+counter+", '"+t+"', '"+n+'\');"><img src="image/folder_open.png?v=2c0ebed2b2" border="0"><a href="javascript:Return_Back('+counter+", '"+t+"', '"+n+"');\"></a><label></label><label></label><label></label></div>":'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList('+counter+", '"+t+"', '"+n+'\');"><a href="javascript:Return_Back('+counter+", '"+t+"', '"+n+"');\"></a><label></label><label></label><label></label></div>",l.innerHTML+=p,document.getElementById("subfolder_"+counter).childNodes[2].innerHTML=y.trueFolderName,document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=u,document.getElementById("subfolder_"+counter).childNodes[3].style.display="none",document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=s,document.getElementById("subfolder_"+counter).childNodes[4].style.display="none",document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=m,document.getElementById("subfolder_"+counter).childNodes[5].style.display="none",counter++,d++}}else document.getElementById("subfolder_"+e).childNodes[1].childNodes[0].src="/image/folder_close.png?v=ed04e0d8c1"}else{s=document.getElementById("subfolder_"+e).childNodes[4].innerHTML,u=document.getElementById("subfolder_"+e).childNodes[3].innerHTML,o=document.getElementById("subfolder_"+e).childNodes[2].innerHTML;var f=document.getElementById("subfolder_"+e);for(y={trueFolderName:o},b=u.match(/\//g),p="",g=1;g<b.length;g++)p+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";f.innerHTML=p+'<a href="javascript:Get_SubFolderList('+e+", '"+t+"', '"+n+"');\" id=subfolder_"+e+'><img src="image/folder_open.png?v=2c0ebed2b2" border="0"></a><a href="javascript:Return_Back('+e+", '"+t+"', '"+n+"');\"></a><label></label><label></label><label></label></div>";m=0;document.getElementById("subfolder_"+e).childNodes[2].innerHTML=y.trueFolderName,document.getElementById("subfolder_"+e).childNodes[3].innerHTML=u,document.getElementById("subfolder_"+e).childNodes[3].style.display="none",document.getElementById("subfolder_"+e).childNodes[4].innerHTML=s,document.getElementById("subfolder_"+e).childNodes[4].style.display="none",document.getElementById("subfolder_"+e).childNodes[5].innerHTML=m,document.getElementById("subfolder_"+e).childNodes[5].style.display="none"}}function GetSubFolderList(e,t,n){if(0==IsOpenFolder){var o=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",e)),r=o.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#"),i=document.getElementById("FolderTreeView"),d=1;i.innerHTML+="<br />";for(var s=0;s<r;s++){var l=o.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryName"),c=o.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryPath"),a=o.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/SubDirectory"),u=l;i.innerHTML+="true"==a?"<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList('+counter+", '"+t+"', '"+n+'\');"><img src="image/folder_open.png?v=2c0ebed2b2" border="0"><a href="javascript:Return_Back('+counter+", '"+t+"', '"+n+"');\">"+u+"</a><label></label><label></label><label></label></div>":"<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList('+counter+", '"+t+"', '"+n+'\');"><a href="javascript:Return_Back('+counter+", '"+t+"', '"+n+"');\">"+u+"</a><label></label><label></label><label></label></div>",document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=c,document.getElementById("subfolder_"+counter).childNodes[3].style.display="none",document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=a,document.getElementById("subfolder_"+counter).childNodes[4].style.display="none",document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=0,document.getElementById("subfolder_"+counter).childNodes[5].style.display="none",counter++,d++}IsOpenFolder=1}}function ReturnBack(e,t){"add"==e?("SAMBA"==t?document.getElementById("SAMBA_Folder").value=document.getElementById("rootName").innerHTML:document.getElementById("FTP_Folder").value=document.getElementById("rootName").innerHTML,document.getElementById("createPop").style.display="block"):("SAMBA"==t?document.getElementById("edit_SAMBA_Folder").value=document.getElementById("rootName").innerHTML:document.getElementById("edit_FTP_Folder").value=document.getElementById("rootName").innerHTML,document.getElementById("editPop").style.display="block"),document.getElementById("treeViewPop").style.display="none"}function Return_Back(e,t,n){"add"==t?"SAMBA"==n?document.getElementById("SAMBA_Folder").value=document.getElementById("subfolder_"+e).childNodes[3].innerHTML:document.getElementById("FTP_Folder").value=document.getElementById("subfolder_"+e).childNodes[3].innerHTML:"SAMBA"==n?document.getElementById("edit_SAMBA_Folder").value=document.getElementById("subfolder_"+e).childNodes[3].innerHTML:document.getElementById("edit_FTP_Folder").value=document.getElementById("subfolder_"+e).childNodes[3].innerHTML,"add"==t?document.getElementById("createPop").style.display="block":document.getElementById("editPop").style.display="block",document.getElementById("treeViewPop").style.display="none"}function ReturnBack2(){document.getElementById("edit_Folder").value=document.getElementById("rootName2").innerHTML,document.getElementById("editPop").style.display="block",document.getElementById("treeViewPop2").style.display="none"}function Return_Back2(e){document.getElementById("edit_Folder").value=document.getElementById("subfolder_"+e).childNodes[3].innerHTML,document.getElementById("editPop").style.display="block",document.getElementById("treeViewPop2").style.display="none"}function GetXML(){var e=new SOAPAction,f=new SOAPGetUsersSettings;userList.length=0;var t=e.sendSOAPAction("GetUsersSettings",null,f);$.when(t).done(function(e){for(var t in f.StorageUsersLists.StorageUser){var n,o,r,i,d,s=f.StorageUsersLists.StorageUser[t],l=s.Enabled,c=s.UserName,a=AES_Decrypt128(s.Password);for(var u in userList.push(c),Total_User+=1,s.ServiceInfoLists.ServiceInfo){var m=s.ServiceInfoLists.ServiceInfo[u],y=m.Enabled,b=m.ServiceName,p=m.AccessPath,g=m.Permission;"SAMBA"==b&&("true"==y?(n="true"==g?"2":"1",i="/"==p?I18N("j","root"):p):(n="0",i="")),"FTP"==b&&("true"==y?(o="true"==g?"2":"1",d="/"==p?I18N("j","root"):p):(o="0",d="")),"VPN"==b&&(r="true"==y?"Enabled":"Disabled")}addRowToTable(null,"",c,a,n,o,r,l,i,d)}check_TotalUser(Limit_TotalUser,Total_User)}),document.getElementById("main").style.display="inline"}function CheckConnectionStatus(){$.ajax({cache:!1,url:"./js/CheckConnection",timeout:5e3,type:"GET",success:function(e){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){var e=I18N("j","Please wait")+" ...";PopView.show(e);var t=document.getElementById(TABLE_NAME),n=new SOAPAction,o=new SOAPSetUsersSettings;if(0<delUserList.length)for(var r=0;r<delUserList.length;r++){var i=new SOAPDelUserSettings;i.UserName=delUserList[r],n.sendSOAPAction("DelUserSettings",i,null)}for(var d=1;d<=Total_User;d++){var s=t.rows[d].childNodes[0].childNodes[0].checked,l=t.rows[d].childNodes[1].childNodes[0].innerHTML,c=t.rows[d].childNodes[2].childNodes[0].innerHTML,a=t.rows[d].childNodes[3].childNodes[0].innerHTML,u=t.rows[d].childNodes[4].childNodes[0].innerHTML,m=passwordAry[d-1],y=t.rows[d].childNodes[9].childNodes[0].innerHTML,b=t.rows[d].childNodes[10].childNodes[0].innerHTML;1==d&&(b=y="/");var p=new SOAPStorageUser;if(p.Enabled=s,p.UserName=l,p.Password=AES_Encrypt128(m),currentDevice.featureUsbPort){var g=new SOAPServiceInfo;"-"==c?(g.Enabled=!1,g.ServiceName="SAMBA"):(g.Enabled=!0,g.ServiceName="SAMBA",y==I18N("j","root")&&(y="/"),g.AccessPath=y,g.Permission=c!=I18N("j","Read Only")),p.ServiceInfoLists.push(g)}if(currentDevice.featureFTPServer&&currentDevice.featureUsbPort){var g=new SOAPServiceInfo;"-"==a?(g.Enabled=!1,g.ServiceName="FTP"):(g.Enabled=!0,g.ServiceName="FTP",b==I18N("j","root")&&(b="/"),g.AccessPath=b,g.Permission=a!=I18N("j","Read Only")),p.ServiceInfoLists.push(g)}(g=new SOAPServiceInfo).Enabled="-"!=u,g.ServiceName="VPN",p.ServiceInfoLists.push(g),o.StorageUsersLists.push(p)}n.sendSOAPAction("SetUsersSettings",o,null).done(function(e){"OK"==e.SetUsersSettingsResult||"RESTART"==e.SetUsersSettingsResult?Start_reciprocal_Number_RestoreConfiguration(!1):"REBOOT"==e.SetUsersSettingsResult?Start_reciprocal_Number_RestoreConfiguration(!0):window.location.reload()})}function Start_reciprocal_Number_RestoreConfiguration(e){var t=I18N("j","Please wait")+" ...",n=I18N("j","The new settings have been saved."),o=currentDevice.okcount,r=new SOAPAction;1==e&&(t=I18N("j","Your changes are being saved, and the device will need to reboot."),o=currentDevice.rebootcount,r.sendSOAPAction("Reboot",null,null)),PopView.showWithCountdown(t,o).always(function(){PopView.showConfirm(n).done(function(){location.reload()})})}function waitSettingFinished(){window.location.reload()}function ChangeBandStatus(e,t){var n=$("#"+e+"status_"+t).prop("checked");switch(t){case"SAMBA":n?$("#"+e+"SAMBA_Permission").selectbox("enable"):$("#"+e+"SAMBA_Permission").selectbox("disable"),$("#"+e+"SAMBA_Folder").attr("disabled",!n),$("#"+e+"searchFolderSAMBA").attr("disabled",!n);break;case"FTP":n?$("#"+e+"FTP_Permission").selectbox("enable"):$("#"+e+"FTP_Permission").selectbox("disable"),$("#"+e+"FTP_Folder").attr("disabled",!n),$("#"+e+"searchFolderFTP").attr("disabled",!n)}}</script><script language="JavaScript">function focusToFirstIndex(e){"save_buttonFocus"==e.id&&9==window.event.keyCode&&document.getElementById("shareport_UserName").focus(),"save_buttonFocus2"==e.id&&9==window.event.keyCode&&document.getElementById("edit_UserName").focus()}</script><script language="JavaScript">function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none",document.getElementById("Save_btn").style.display="block",changeFlag=!0,changeTimeoutAction()}$(function(){$("select").change(function(){save_button_changed()}),$("input").keydown(function(){save_button_changed()})})</script></head><body><div id="wrapper"><div id="header"></div><div id="menu"></div><div id="menu_edge"></div><div id="content"><div id="info"><div id="FunctionName"><script>I18N("h","User")</script></div><div id="wallimage"><img src="image/page_userDevice.png?v=f74e15ad69" alt="" width="195" height="119"></div><div id="directions"><script>I18N("h","Use this page to create user accounts to manage access to services provided by the router.")</script></div></div><div id="funcBar"><div id="pagePath">&nbsp;<script>I18N("h","Management")</script>&nbsp;&gt;&gt;&nbsp;<script>I18N("h","User")</script></div><ul id="rightFunc"><li style="display:block"><div id="Save_btn" onclick="CheckConnectionStatus(),changeTimeoutAction()" style="cursor:pointer;display:none"><script>I18N("h","Save")</script></div></li><li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save")</script></div></li></ul></div><div id="main" style="display:none"><form id="dlquickvpnsettings" action="" method="post"><table class="myTable2" border="0" cellspacing="0" id="tblUserList"><thead><tr><th><script>I18N("h","Status")</script></th><th><script>I18N("h","Name")</script></th><th id="SAMBA_userList"><script>I18N("h","SAMBA")</script></th><th id="FTP_userList"><script>I18N("h","FTP")</script></th><th><script>I18N("h","VPN")</script></th><th><script>I18N("h","Export VPN Profile (iOS/Mac OS X)")</script></th><th><script>I18N("h","Edit")</script></th><th><script>I18N("h","Delete")</script></th><th style="display:none"><script>I18N("h","Password")</script></th><th style="display:none"></th><th style="display:none"></th></tr></thead><tbody></tbody></table></form><br><br><button type="button" name="createButton" id="createButton" class="styled_button_s" onclick="createUserButton()"><script>I18N("h","Create User")</script></button> &nbsp;&nbsp;<script>I18N("h","Remaining")</script>:&nbsp;<label id="RemainingRules">9</label><br><div id="treeViewPop" style="display:none"><div class="dialogBox" style="width:550px;height:400px"><div id="closeCreatePopBtn" onclick="closeTreeViewPOP()" style="cursor:pointer"></div><table class="myCreatePop_table_left" style="width:200px" border="0" cellspacing="0" id="tblTreeView1"><tbody><tr><td><div class="popTitle_s"><script>I18N("h","Disk Name")</script></div></td></tr><td><div id="partitionView" style="overflow:auto;height:350px;width:175px;text-align:left;margin:0 0 0 10px;white-space:nowrap"></div></td></tbody></table><table class="myCreatePop_table_right" style="width:350px" border="0" cellspacing="0" id="tblTreeView2"><tbody><tr><td><div class="popTitle_s"><script>I18N("h","Select Folder")</script></div></td></tr><td><div id="FolderTreeView" style="overflow:auto;height:350px;width:340px;text-align:left;line-height:25px;border-style:groove;white-space:nowrap"><a href="javascript:ReturnBack();" id="rootName" style="margin:0 0 0 10px"></a></div></td></tbody></table></div></div><div id="treeViewPop2" style="display:none"><div class="dialogBox" style="width:550px;height:400px"><div id="closeCreatePopBtn" onclick="closeTreeView2POP()" style="cursor:pointer"></div><table class="myCreatePop_table_left" style="width:200px" border="0" cellspacing="0" id="tblTreeView3"><tbody><tr><td><div class="popTitle_s"><script>I18N("h","Disk Name")</script></div></td></tr><td><div id="partitionView2" style="overflow:auto;height:350px;text-align:left;margin:0 0 0 10px"></div></td></tbody></table><table class="myCreatePop_table_right" style="width:350px" border="0" cellspacing="0" id="tblTreeView4"><tbody><tr><td><div class="popTitle_s"><script>I18N("h","Select Folder")</script></div></td></tr><td><div id="FolderTreeView2" style="overflow:auto;height:350px;width:340px;text-align:left;line-height:25px;border-style:groove;white-space:nowrap"><a href="javascript:ReturnBack2();" id="rootName2" style="margin:0 0 0 10px"></a></div></td></tbody></table></div></div></div></div><div id="DetectRouterConnection" style="display:none"></div><div id="footer"><div id="copyright"><script>I18N("h","COPYRIGHT")</script></div></div></div><form name="user_c1_form" id="user_c1_form" action=""><input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"><div id="createPop" style="display:none"><div class="dialogBox" style="width:550px"><div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div><table class="myCreatePop_table" border="0" cellspacing="0" id="tblUserList2"><tr><td colspan="3"><div class="popTitle"><script>I18N("h","Create New User")</script></div></td></tr><tr><th><script>I18N("h","User Name")</script>:</th><td colspan="2"><input class="styled-text required" type="text" name="shareport_UserName" size="27" maxlength="20" id="shareport_UserName" tabindex="1"></td></tr><tr><th><script>I18N("h","Password")</script>:</th><td colspan="2"><input class="styled-text" type="text" name="shareport_Password" size="27" maxlength="32" id="shareport_Password" tabindex="2"></td></tr><tbody id="SAMBA_Dialog"><tr><td colspan="3"><div class="title" style="margin:0 0 10px 30px"><script>I18N("h","SAMBA")</script></div></td></tr><tr><th><script>I18N("h","Status")</script>:</th><td><input type="checkbox" class="chkbox" id="status_SAMBA" onchange='ChangeBandStatus("","SAMBA")' checked="checked"><label for="status_SAMBA"><span class="chkbox_disabled"><script>I18N("h","Disabled")</script></span><span class="chkbox_enabled"><script>I18N("h","Enabled")</script></span></label></td></tr><tr><th><script>I18N("h","Permission")</script>:</th><td colspan="2"><div class="styled-select"><select style="width:80px" name="SAMBA_PermissionSelect" id="SAMBA_Permission"><option value="1">Read Only</option><option value="2">Read/Write</option></select></div></td></tr><tr><th><script>I18N("h","Folder")</script>:</th><td style="width:150px"><input class="styled-text" type="text" name="SAMBA_Folder" size="27" id="SAMBA_Folder"></td><td><button type="button" name="searchFolderSAMBA" id="searchFolderSAMBA" class="styled_button_ss" tabindex="3" onclick='GetDirectoryList("add","SAMBA")'><script>I18N("h","Browse")</script></button></td></tr></tbody><tbody id="FTP_Dialog"><tr><td colspan="3"><div class="title" style="margin:0 0 10px 30px"><script>I18N("h","FTP")</script></div></td></tr><tr><th><script>I18N("h","Status")</script>:</th><td><input type="checkbox" class="chkbox" id="status_FTP" onchange='ChangeBandStatus("","FTP")'><label for="status_FTP"><span class="chkbox_disabled"><script>I18N("h","Disabled")</script></span><span class="chkbox_enabled"><script>I18N("h","Enabled")</script></span></label></td></tr><tr><th><script>I18N("h","Permission")</script>:</th><td colspan="2"><div class="styled-select"><select style="width:80px" name="FTP_PermissionSelect" id="FTP_Permission"><option value="1">Read Only</option><option value="2">Read/Write</option></select></div></td></tr><tr><th><script>I18N("h","Folder")</script>:</th><td style="width:150px"><input class="styled-text" type="text" name="FTP_Folder" size="27" id="FTP_Folder" readonly="true"></td><td><button type="button" name="searchFolderFTP" id="searchFolderFTP" class="styled_button_ss" tabindex="3" onclick='GetDirectoryList("add","FTP")'><script>I18N("h","Browse")</script></button></td></tr></tbody><tr><td colspan="3"><div class="title" style="margin:0 0 10px 30px"><script>I18N("h","VPN")</script></div></td></tr><tr><th><script>I18N("h","Status")</script>:</th><td><input type="checkbox" class="chkbox" id="status_VPN" onchange='ChangeBandStatus("","VPN")'><label for="status_VPN"><span class="chkbox_disabled"><script>I18N("h","Disabled")</script></span><span class="chkbox_enabled"><script>I18N("h","Enabled")</script></span></label></td></tr><tr><td id="save_td" colspan="3"><center><button type="button" class="styled_button_s" id="save_buttonFocus" tabindex="4" onkeyup="focusToFirstIndex(this)" onclick='document.getElementById("sumbit_CheckData").click()'><script>I18N("h","OK")</script></button></center></td></tr></table></div></div></form><form name="user_c2_form" id="user_c2_form" action=""><input id="sumbit_CheckData2" class="submit" type="submit" value="Submit" style="display:none"><div id="editPop" style="display:none"><div class="dialogBox" style="width:550px"><div id="closeCreatePopBtn" onclick="clearEditRulePOP()" style="cursor:pointer"></div><table class="myCreatePop_table" border="0" cellspacing="0" id="tblUserList3"><tbody><tr><td colspan="3"><div class="popTitle"><script>I18N("h","Edit User Profile")</script></div></td></tr><tr><th><script>I18N("h","User Name")</script>:</th><td colspan="2"><input class="styled-text required" type="text" name="edit_UserName" size="27" maxlength="20" id="edit_UserName" tabindex="5" onchange="OnChangeUserName(this.value)"></td></tr><tr><th><script>I18N("h","Password")</script>:</th><td colspan="2"><input class="styled-text" type="text" name="edit_Password" size="27" maxlength="32" id="edit_Password" tabindex="2"></td></tr></tbody><tbody id="SAMBA_Dialog2"><tr><td colspan="3"><div class="title" style="margin:0 0 10px 30px"><script>I18N("h","SAMBA")</script></div></td></tr><tr><th><script>I18N("h","Status")</script>:</th><td><input type="checkbox" class="chkbox" id="edit_status_SAMBA" onchange='ChangeBandStatus("edit_","SAMBA")'><label for="edit_status_SAMBA"><span class="chkbox_disabled"><script>I18N("h","Disabled")</script></span><span class="chkbox_enabled"><script>I18N("h","Enabled")</script></span></label></td></tr><tr><th><script>I18N("h","Permission")</script>:</th><td colspan="2"><div class="styled-select"><select style="width:80px" name="edit_SAMBA_PermissionSelect" id="edit_SAMBA_Permission"><option value="1">Read Only</option><option value="2">Read/Write</option></select></div></td></tr><tr><th><script>I18N("h","Folder")</script>:</th><td style="width:150px"><input class="styled-text" type="text" name="edit_SAMBA_Folder" size="27" id="edit_SAMBA_Folder" readonly="true"></td><td><button type="button" name="edit_searchFolderSAMBA" id="edit_searchFolderSAMBA" class="styled_button_ss" tabindex="3" onclick='GetDirectoryList("edit","SAMBA")'><script>I18N("h","Browse")</script></button></td></tr></tbody><tbody id="FTP_Dialog2"><tr><td colspan="3"><div class="title" style="margin:0 0 10px 30px"><script>I18N("h","FTP")</script></div></td></tr><tr><th><script>I18N("h","Status")</script>:</th><td><input type="checkbox" class="chkbox" id="edit_status_FTP" onchange='ChangeBandStatus("edit_","FTP")'><label for="edit_status_FTP"><span class="chkbox_disabled"><script>I18N("h","Disabled")</script></span><span class="chkbox_enabled"><script>I18N("h","Enabled")</script></span></label></td></tr><tr><th><script>I18N("h","Permission")</script>:</th><td colspan="2"><div class="styled-select"><select style="width:80px" name="edit_FTP_PermissionSelect" id="edit_FTP_Permission"><option value="1">Read Only</option><option value="2">Read/Write</option></select></div></td></tr><tr><th><script>I18N("h","Folder")</script>:</th><td style="width:150px"><input class="styled-text" type="text" name="edit_FTP_Folder" size="27" id="edit_FTP_Folder" readonly="true"></td><td><button type="button" name="edit_searchFolderFTP" id="edit_searchFolderFTP" class="styled_button_ss" tabindex="3" onclick='GetDirectoryList("edit","FTP")'><script>I18N("h","Browse")</script></button></td></tr></tbody><tbody><tr><td colspan="3"><div class="title" style="margin:0 0 10px 30px"><script>I18N("h","VPN")</script></div></td></tr><tr><th><script>I18N("h","Status")</script>:</th><td><input type="checkbox" class="chkbox" id="edit_status_VPN" onchange='ChangeBandStatus("edit_","VPN")'><label for="edit_status_VPN"><span class="chkbox_disabled"><script>I18N("h","Disabled")</script></span><span class="chkbox_enabled"><script>I18N("h","Enabled")</script></span></label></td></tr></tbody><tr><td id="save_td" colspan="3"><center><button type="button" class="styled_button_s" id="save_buttonFocus2" tabindex="7" onkeyup="focusToFirstIndex(this)" onclick='document.getElementById("sumbit_CheckData2").click()'><script>I18N("h","OK")</script></button></center></td></tr></table></div></div></form><div id="popalert" class="black_overlay" style="display:none"><div class="popup_window_border" style="position:relative;top:15%"><div class="popup_window"><div id="popalert_circle"><img src="image/loading.gif?v=082200f467" width="62px" height="62px"></div><div id="popalert_countdown"></div><div id="popalert_desc"></div><div id="popalert_buttons" class="btn-group" role="group" aria-label="..."><button type="button" id="popalert_ok" class="btn btn-default"><script>I18N("h","OK")</script></button></div></div></div></div><script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkHEXChar",function(e,r){return!!/^[a-zA-Z0-9_-]+$/.test(e)},jQuery.validator.messages.check_IllegalChar),$("#user_c1_form, #user_c2_form").each(function(e,r){$(r).validate({rules:{shareport_UserName:{required:!0,checkHEXChar:!0},edit_UserName:{required:!0,checkHEXChar:!0}},messages:{shareport_UserName:{required:jQuery.validator.messages.check_UserName},edit_UserName:{required:jQuery.validator.messages.check_UserName}},submitHandler:function(e){"user_c1_form"==e.id&&closeCreateUserPOP(),"user_c2_form"==e.id&&(closeEditUserPOP(set_Iteration),save_button_changed())},debug:!0})})})</script><script type="text/javascript">Load_HTML(),Initial(),setMenu("menu_Management"),GetXML(),startTimeout()</script></body></html><!-- svn info: $Revision: 1254 $ $Date: 2019-01-08 18:02:33 +0800 (Tue, 08 Jan 2019) $ --> 
