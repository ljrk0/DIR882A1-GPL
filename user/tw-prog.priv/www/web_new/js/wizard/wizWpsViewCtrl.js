/* svn info: $Revision: 1404 $ $Date: 2019-04-23 11:10:34 +0800 (Tue, 23 Apr 2019) $ */
define(["wizPath/wizardViewController","wizPath/wizardModel","wizPath/wizardView"],function(e,t,n){var i,r,c=null,s=null;function o(e){return i=$.Deferred(),r=e,$("#RetryBtn").off("click").on("click",function(){l(),$(this).hide()}).hide(),l(),$("#DUTToClientRight").attr("src","image/wireless_on.gif"),$("#DUTToClientLeft").attr("src","image/wireless_on_180.gif"),$("#wizard_title").html(I18N("j","Install")),$("#Wizard2").show(),$("#wizButton_next").html(I18N("j","Wi-Fi")).show().off("click").on("click",function(){d(),a(),i.resolve("sitesurvey")}),$("#wizButton_back").html(I18N("j","Ethernet")).show().off("click").on("click",function(){d(),r.opMode="WirelessAp",$("#RT_to_DUT_Wired").show(),$("#RT_to_DUT_Wireless").hide(),i.resolve("eth")}),$("#closeWizBtn").off("vclick").on("vclick",function(){d(),i.reject()}),i.promise()}function l(){var e=120,t='<span id="wps_countdown">'+e+"</span>";$("#Wizard2Desc").html(I18N("j","Please press the WPS button on the router or access point you want to extend with in %s seconds, or select the type of existing network below.",t));var n=$("#wps_countdown");c=setInterval(function(){0<e?(e--,n.html(e)):o()},1e3),startWPSPBC(e).progress(function(e){s=e}).done(function(e){var o;d(),o=e.RadioID,getAPCsettings(o).then(function(e){a(),r.apcSSID=e.SSID,r.apcPWD=e.Key,r.wps=!0;var t=new SOAPAction,n=createOPmode(o,r.opMode);return t.sendSOAPAction("SetOperationMode",n,null)}).done(function(){i.resolve("wifi")})}).fail(function(){o()});var o=function(){d(),$("#Wizard2Desc").html(I18N("j","We couldn't find a Wi-Fi network through WPS. Click <b>Retry</b> to try again, or select a connection method below.")),$("#RetryBtn").show()}}function a(){r.opMode="WirelessRepeaterExtender",$("#RT_to_DUT_Wired").hide(),$("#RT_to_DUT_Wireless").show()}function d(){clearInterval(s),clearInterval(c)}return{init:function(e){return o(e)}}});