/* svn info: $Revision: 847 $ $Date: 2018-06-06 18:37:11 +0800 (Wed, 06 Jun 2018) $ */
function Datalist(){this.list=new Array,this.maxrowid=0}function Data(t,e,i,s,r){this.name=t,this.ipAddress=e,this.tcpPort=this.reassemblePort(i),this.udpPort=this.reassemblePort(s),""==r||"always"==r.toLowerCase()?this.schedule="Always":this.schedule=r,this.setEnable("true")}Datalist.prototype.getData=function(t){var e,i;for(e=0;e<this.list.length&&(i=this.list[e]).rowid!=t;e++);return i},Datalist.prototype.getRowNum=function(t){var e=0;for(e=0;e<this.list.length&&t!=this.list[e].rowid;e++);return e},Datalist.prototype.editData=function(t,e){var i=this.getRowNum(t);return 0!=this.checkData(e,i)&&(e.setRowid(t),this.list.splice(i,1,e),e.setDataToRow($("#tr"+e.rowid)),!0)},Datalist.prototype.deleteData=function(t){var e=this.getRowNum(t);this.list.splice(e,1),$("#tr"+t).remove()},Datalist.prototype.push=function(t){return 0!=this.checkData(t,null)&&(t.setRowid(this.maxrowid),this.list.push(t),this.maxrowid++,t.addRowToHTML("tblPortForwarding"),!0)},Datalist.prototype.checkData=function(t,e){var i;for(i=0;i<this.list.length;i++)if(i!=e){if(this.list[i].name==t.name)return alert(I18N("j","Name cannot be the same.")),!1;if(this.list[i].ipAddress==t.ipAddress&&this.list[i].tcpPort==t.tcpPort&&this.list[i].udpPort==t.udpPort&&this.list[i].schedule==t.schedule)return alert(I18N("j","Rule cannot be the same.")),!1}return!0},Datalist.prototype.length=function(){return this.list.length},Data.prototype={rowid:null,enable:null,name:null,ipAddress:null,tcpPort:null,udpPort:null,schedule:null,setRowid:function(t){this.rowid=t},setEnable:function(t){this.enable=t},reassemblePort:function(t){var e=t.split(","),i="";if(""==t)return i;for(var s=0;s<e.length;s++){0<s&&(i+=",");var r=e[s].split("-");i+=parseInt(r[0],10),0==isNaN(r[1])&&(i+="-"+parseInt(r[1],10))}return i},showEnable:function(){var t="",e="true";return"true"==this.enable&&(t="checked",e="false"),'<input type="checkbox" onchange="datalist.list['+this.rowid+"].setEnable('"+e+"')\" "+t+"/>"},showName:function(){return HTMLEncode(this.name)},showTCPPort:function(){return""==this.tcpPort?"N/A":this.tcpPort},showUDPPort:function(){return""==this.udpPort?"N/A":this.udpPort},showSchedule:function(){return"Always"==this.schedule||""==this.schedule?I18N("j","Always"):AllEncode(decode_char_text(this.schedule))},addRowToHTML:function(t){var e;e="<tr id='tr"+this.rowid+"'></tr>",$("#"+t+"> tbody").append(e),this.setDataToRow($("#tr"+this.rowid))},setDataToRow:function(t){var e;e="<td>"+this.showEnable()+"</td>",e+="<td>"+this.showName()+"</td>",e+="<td>"+this.ipAddress+"</td>",e+="<td>"+this.showTCPPort()+"</td>",e+="<td>"+this.showUDPPort()+"</td>",e+="<td>"+this.showSchedule()+"</td>",e+="<td><img src='image/edit_btn.png?v=2fc10c4616' width=28 height=28 style='cursor:pointer' onclick='editData("+this.rowid+")'/></td>",e+="<td><img src='image/trash.png?v=8fee37bb10' width=41 height=41 style='cursor:pointer' onclick='deleteData("+this.rowid+")'/></td>",t.html(e)}};