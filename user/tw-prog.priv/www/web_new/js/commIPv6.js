/* svn info: $Revision: 1204 $ $Date: 2018-12-04 17:31:36 +0800 (Tue, 04 Dec 2018) $ */
function COMM_IPv6ADDR2INT(d){for(var a=new Array(8),f=0;f<a.length;f++)a[f]=0;var r=d.split("::"),t=r[0].split(":");for(f=0;f<t.length;f++)a[f]=parseInt(t[f],16);if(1<r.length){var n=r[1].split(":");for(f=0;f<n.length;f++)a[a.length-1-f]=parseInt(n[f],16)}return a}function COMM_IPv6NETWORK(d,a){var f=COMM_IPv6ADDR2INT(d),r=Math.floor(a/16),t=a%16;if(0<t){var n=Math.pow(2,16)-Math.pow(2,16-t);f[r]&=n,r++}for(var A=r;A<f.length;A++)f[A]=0;return f}function COMM_ValidV6Format(d,a){for(var f=d.split(":"),r=0;r<f.length;r++)f[r]=parseInt(f[r],16);return 0!=f[0]&&(!(65280<=f[0]&&f[0]<=65295)&&(!a||65152!=f[0]&&8194!=f[0]))}function COMM_V6Format(d){return 0!=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))))(%.+)?\s*$/.test(d)}function COMM_ValidV6Prefix(d,a){for(var f=d.split(":"),r=0;r<f.length;r++)f[r]=parseInt(f[r],16);return 0!=f[0]&&(!(65280<=f[0]&&f[0]<=65295)&&(!a||65152!=f[0]&&8194!=f[0]))}function BoolToEnable(d){return d?"Enable":"Disable"}function getPrefix(d,a){for(var f=COMM_IPv6ADDR2INT(d),r=new Array(8),t=a,n=0,A=":",F=0;F<r.length;F++)r[F]=0;for(;16<t;)r[n]=f[n],t-=16,n++;0<t&&(r[n]=f[n]>>16-t<<16-t);var e=!0;for(F=r.length-1;0<=F;F--)0==r[F]&&e||(e=!1,A=r[F].toString(16)+":"+A);return A}function get6to4addr(d){var a=d.split("."),f=new Array(4);if(4!=a.length)return"";for(var r=0;r<a.length;r++)f[r]=parseInt(a[r],10);return"2002:"+f[0].toString(16)+f[1].toString(16)+":"+f[2].toString(16)+f[3].toString(16)+"::1"}function COMM_V6Format_Simple(d){return 0!=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/.test(d)}