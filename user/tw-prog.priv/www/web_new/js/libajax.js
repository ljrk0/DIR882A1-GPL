/* svn info: $Revision: 887 $ $Date: 2018-06-20 14:56:02 +0800 (Wed, 20 Jun 2018) $ */
function XmlDocument(e){this.XDoc=e,this.AnchorNode=null}function HTTPClient(){}function GetAjaxObj(e){var t=0,r=new Array,s=r.length;if(0<s)for(t=0;t<s;t+=1)if(r[t][0]==e)return r[t][1];return r[s]=new Array,r[s][0]=e,r[s][1]=new HTTPClient,r[s][1]}XmlDocument.prototype={Serialize:function(){return window.ActiveXObject?this.XDoc.xml:(new XMLSerializer).serializeToString(this.XDoc)},dbgdump:function(){var e=window.open();e.document.open("content-type: text/xml"),e.document.write(this.Serialize())},Find:function(e,t){var r,s,i,n,o=this.XDoc,h=e.split("/");for(o=this.AnchorNode&&""!=h[0]?this.AnchorNode:this.XDoc,r=0;r<h.length;r+=1)if(""!=h[r]){if(h[r].indexOf(":")<0)i=h[r],n=1;else{var a=h[r].split(":");i=a[0],n=a[1]}var u,d=0,l=0;for(s=0;s<o.childNodes.length;s+=1)if(o.childNodes[s].nodeName==i&&n==(d+=1)){o=o.childNodes[s],l+=1;break}if(!l){if(!t)return null;for(s=0;s<n-d;s+=1)u=this.XDoc.createElement(i),o.appendChild(u);o=u}}return o},Anchor:function(e){var t=this.AnchorNode;return e&&""!==e&&(this.AnchorNode=this.Find(e,!1)),t},AnchorPop:function(e){this.AnchorNode=e},GetDOMNodeValue:function(e){return e.hasChildNodes()?e.firstChild.nodeValue:""},GetDOMNodeAttr:function(e,t){return e.hasChildNodes()?1==e.firstChild.nodeType?e.firstChild.getAttribute(t):e.getAttribute(t):""},SetDOMNodeValue:function(e,t){if(e.hasChildNodes())e.firstChild.nodeValue=t;else{var r=this.XDoc.createTextNode(t);e.appendChild(r)}},SetDOMNodeAttr:function(e,t,r){e.hasChildNodes()&&(1==e.firstChild.nodeType?e.firstChild.setAttribute(t,r):e.setAttribute(t,r))},Del:function(e){var t=this.Find(e);return null!=t&&(t.parentNode.removeChild(t),!0)},Get:function(e){var t,r=e.split("/")[e.split("/").length-1],s=!1;if("Password"!=r&&"IPv6_PppoePassword"!=r&&"Key"!=r&&"AdminPassword"!=r&&"AccountPassword"!=r&&"RadiusSecret1"!=r&&"RadiusSecret2"!=r&&"MK"!=r||(s=!0),e.indexOf("#")<0)return(t=this.Find(e,!1))?s?AES_Decrypt128(this.GetDOMNodeValue(t)):this.GetDOMNodeValue(t):"";var i=0,n=e.split("#");if(t=this.Find(n[0])){var o=t.nodeName;t=t.parentNode;for(var h=0;h<t.childNodes.length;h+=1)t.childNodes[h].nodeName==o&&(i+=1)}return i},GetAttr:function(e,t){var r;return e.indexOf("#")<0&&(r=this.Find(e,!1))?this.GetDOMNodeAttr(r,t):""},Set:function(e,t){var r=e.split("/")[e.split("/").length-1];"Password"!=r&&"IPv6_PppoePassword"!=r&&"Key"!=r&&"AdminPassword"!=r&&"AccountPassword"!=r&&"RadiusSecret1"!=r&&"RadiusSecret2"!=r&&"MK"!=r||(t=AES_Encrypt128(t));var s=this.Find(e,!0);return null==s?(alert("BUG(Set): this should not happen !!"),null):(null==t&&(t=""),this.SetDOMNodeValue(s,t),s)},SetAttr:function(e,t,r){var s=this.Find(e,!0);return null==s?(alert("BUG(SetAttr): this should not happen !!"),null):(this.SetDOMNodeAttr(s,t,r),s)},Add:function(e,t){var r=this.Find(e,!1);if(null==r)return r=this.Find(e,!0),this.SetDOMNodeValue(r,t),r;var s=r.parentNode,i=this.XDoc.createElement(r.nodeName);return this.SetDOMNodeValue(i,t),s.appendChild(i),i},GetPathByTarget:function(e,t,r,s,i){var n,o,h,a,u,d=!1,l=0;if(null==(h=this.Find(e,i)))return null;for(n=0;n<h.childNodes.length&&!d;n+=1)if(h.childNodes[n].nodeName==t){for(l+=1,a=h.childNodes[n],o=0;o<a.childNodes.length;o+=1)if(a.childNodes[o].nodeName==r){u=a.childNodes[o],this.GetDOMNodeValue(u)==s&&(d+=1);break}if(d)return e+"/"+t+":"+l}if(i){var c=e+"/"+t+":"+(l+=1)+"/"+r;return this.Set(c,s),e+"/"+t+":"+l}return null}},HTTPClient.prototype={debug:!1,__httpRequest:null,requestMethod:"POST",requestAsyn:!0,returnXml:!0,__header:null,onSend:null,onCallback:null,onError:function(e){if(!e)throw e},__callback:function(){if(this.__httpRequest){if(2==this.__httpRequest.readyState)this.onSend&&this.onSend();else if(4==this.__httpRequest.readyState)if(200==this.__httpRequest.status){if(this.onCallback)if(this.returnXml){var e=new XmlDocument(this.__httpRequest.responseXML);null!=e?(this.debug&&e.dbgdump(),this.onCallback(e)):this.onError("Error : unable to create XmlDocument().")}else this.onCallback(this.__httpRequest.responseText)}else location.pathname.toLowerCase().indexOf("login")<0&&(this.__httpRequest.getResponseHeader("Content-Type")&&this.__httpRequest.getResponseHeader("Content-Type").toLowerCase().indexOf("xml")<0||401==this.__httpRequest.status||403==this.__httpRequest.status)&&(sessionStorage.removeItem("PrivateKey"),location.assign("/")),this.onError("Error : Request return error("+this.__httpRequest.status+").")}else this.onError("Error : Request return error("+this.__httpRequest.status+").")},createRequest:function(){try{this.__httpRequest=new XMLHttpRequest}catch(e){for(var t=new Array("MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"),r=!1,s=0;s<t.length&&0==r;s+=1){try{this.__httpRequest=new ActiveXObject(t[s]),r=!0}catch(e){}r||this.onError("Browser do not support Ajax.")}}},sendRequest:function(e,t){this.__httpRequest||this.createRequest();var r=this;if(this.__httpRequest.onreadystatechange=function(){r.__callback()},e){if(/iPhone/.test(navigator.userAgent)||/iPad/.test(navigator.userAgent)||/iPod/.test(navigator.userAgent)){var s=(new Date).getTime(),i=e.indexOf("?");e+=-1!=i?"&dummy="+s:"?dummy="+s}if(this.__httpRequest.open(this.requestMethod,e,this.requestAsyn),this.__header)for(var n=0;n<this.__header.length;n+=1)""!=this.__header[n].value&&this.__httpRequest.setRequestHeader(this.__header[n].name,this.__header[n].value);if("GET"==this.requestMethod||"get"==this.requestMethod)this.__httpRequest.send(null);else{if(!t)return void this.onError("Error : Invalid payload for POST.");this.__httpRequest.send(t)}}else this.onError("Error : Invalid request URL.")},getResponseHeader:function(e){return e?this.__httpRequest?this.__httpRequest.getResponseHeader(e):(this.onError("Error : The HTTP request object is not exist."),""):(this.onError("Error : You must assign a header name to get."),"")},getAllResponseHeaders:function(){if(this.__httpRequest)return this.__httpRequest.getAllResponseHeaders();this.onError("Error : The HTTP request object is not exist.")},setHeader:function(e,t){if(e&&t){this.__header||(this.__header=new Array);var r=new Object;r.name=e,r.value=t,this.__header[this.__header.length]=r}},clearHeader:function(e){if(this.__header&&e)for(var t=0;t<this.__header.length;t+=1)if(this.__header[t].name==e)return void(this.__header.value="")},clearAllHeaders:function(){this.__header&&(this.__header=null)},release:function(){this.__httpRequest=null,this.requestMethod="POST",this.requestAsyn=!0,this.returnXml=!0,this.__header=null,this.onCallback=null,this.onSend=null}};