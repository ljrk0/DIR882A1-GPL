/* svn info: $Revision: 847 $ $Date: 2018-06-06 18:37:11 +0800 (Wed, 06 Jun 2018) $ */
define("ClientListView",["QoSView"],function(e){new e;var n=function(e){this.DOM=e,this.objList=new Array,this.MaxCount=3,this.QoSShowStatus=null};n.prototype.push=function(e){return!(this.objList.length>=this.MaxCount)&&(this.objList.push(e),e.line=this,!0)},n.prototype.remove=function(e){var i=this.objList.indexOf(e);return 0<=i&&(this.objList.splice(i,1),!0)};var _=function(e){this.DOM=e,this.line,this.type,this.qosViewController=null,this.MacAddress,this.Live=!0},i=function(){this.lineList=new Array};function t(){$("#editPop").hide(),$("input").val(""),$("#editMac_Info").hide(),$("select").selectbox("detach"),$("#schedule").val("Always"),$("select").selectbox("attach"),$("#client_IPAdrReserve_warning").remove(),$("#client_form").validate().resetForm(),$("#client_form input").removeClass("error")}return i.prototype.createLine=function(){var e=$("#client_line").clone();e.attr("id","");var i=new n(e);return this.lineList.push(i),e.appendTo("#client_items"),e.css("display","table"),i},i.prototype.generateClientHTML=function(e){var i,n=e.NickName,t="../image/",s=e.IPv4Address,l=e.Vendor;if(void 0===e.MacAddress||0==e.MacAddress.length)return null;""==n&&(n="Unknown");var d=!1;"PHONE"==e.DeviceType.toUpperCase()&&(d=!0);var r=e.Type.toUpperCase();if(0<=r.indexOf("WIFI_"))switch(r){case"WIFI_5G":case"WIFI_5G_GUEST":i=d?t+"phone_5g.png":t+"wifi_5g.png";break;case"WIFI_5G_2":case"WIFI_5G_2_GUEST":i=d?t+"phone_5g2.png":t+"wifi_5g2.png";break;default:i=d?t+"MobileDevice.png":t+"wireless_icon.png"}else"OFFLINE"==r?(s=e.ReserveIP,i=t+"EthernetClient_Disconnected.png"):i=t+"EthernetClient.png";22<(l=e.Vendor).length&&(l=l.substr(0,19)+"...");var c=$("#client_obj").clone();c.attr("id",""),c.css("display","inline-block"),c.find(".link_icon").attr("src",i),0<=r.indexOf("WIFI_5G")?c.find(".link_icon").addClass("link_icon_band"):c.find(".link_icon").removeClass("link_icon_band"),c.find(".client_Name").html(n);var o=c.find(".client_Vender");o.html(l);var a=c.find(".client_IPv4Address");if(a.html(s),""!=e.IPv6Address?(o.addClass("client_IPv6Offset"),a.addClass("client_IPv6Offset"),c.find(".client_IPv6Address").css("display","inline-block").html(e.IPv6Address)):(o.removeClass("client_IPv6Offset"),a.removeClass("client_IPv6Offset"),c.find(".client_IPv6Address").hide()),e.MacfilterEnabled?c.find(".client_Access").css("display","inline-block"):c.find(".client_Access").hide(),"OFFLINE"==r&&c.find(".client_Name").addClass("client_Name_Offline"),r.indexOf("WIFI_")<0)c.find(".client_signal").hide();else switch(e.SignalStrength){case"1":case"2":case"3":case"4":var h=c.find(".client_signal");h.children("img").attr("src",t+"signal"+e.SignalStrength+".png"),h.show();break;default:c.find(".client_signal").hide()}return new _(c)},i.prototype.generateNewHTML=function(){return new _($('<div class ="client_add_Tag"></div>'))},i.prototype.getClientView=function(e){for(var i in this.lineList){var n=this.lineList[i];for(var t in n.objList){var s=n.objList[t];if(s.MacAddress==e.MacAddress)return s}}return null},i.prototype.updateClientHTML=function(e,i){var n,t=e.DOM,s=i.NickName,l="../image/",d=i.IPv4Address,r=i.Vendor;if(void 0===i.MacAddress||0==i.MacAddress.length)return null;""==s&&(s="Unknown");var c=!1;"PHONE"==i.DeviceType.toUpperCase()&&(c=!0);var o=i.Type.toUpperCase();if(0<=o.indexOf("WIFI_"))switch(o){case"WIFI_5G":case"WIFI_5G_GUEST":n=c?l+"phone_5g.png":l+"wifi_5g.png";break;case"WIFI_5G_2":case"WIFI_5G_2_GUEST":n=c?l+"phone_5g2.png":l+"wifi_5g2.png";break;default:n=c?l+"MobileDevice.png":l+"wireless_icon.png"}else"OFFLINE"==o?(d=i.ReserveIP,n=l+"EthernetClient_Disconnected.png"):n=l+"EthernetClient.png";22<(r=i.Vendor).length&&(r=r.substr(0,19)+"..."),t.find(".link_icon").attr("src",n),0<=o.indexOf("WIFI_5G")?t.find(".link_icon").addClass("link_icon_band"):t.find(".link_icon").removeClass("link_icon_band"),t.find(".client_Name").html(s);var a=t.find(".client_Vender");a.html(r);var h=t.find(".client_IPv4Address");if(h.html(d),""!=i.IPv6Address?(a.addClass("client_IPv6Offset"),h.addClass("client_IPv6Offset"),t.find(".client_IPv6Address").css("display","inline-block").html(i.IPv6Address)):(a.removeClass("client_IPv6Offset"),h.removeClass("client_IPv6Offset"),t.find(".client_IPv6Address").hide()),i.MacfilterEnabled?t.find(".client_Access").css("display","inline-block"):t.find(".client_Access").hide(),"OFFLINE"==o?t.find(".client_Name").addClass("client_Name_Offline"):t.find(".client_Name").removeClass("client_Name_Offline"),o.indexOf("WIFI_")<0)t.find(".client_signal").hide();else switch(i.SignalStrength){case"1":case"2":case"3":case"4":var _=t.find(".client_signal");_.children("img").attr("src",l+"signal"+i.SignalStrength+".png"),_.show();break;default:t.find(".client_signal").hide()}},i.prototype.deleteClientHTML=function(e){var i=this.getClientView(e);null!=i&&(i.DOM.remove(),i.line.remove(i))},i.prototype.showEditData=function(e){changeTimeoutAction(),$("#check_btn").attr("class","styled_button_dis").prop("disabled",!0),$("#popTitle").html(I18N("j","Edit Rule")),$("#show_Vendor").show(),$("#client_MACAddress").show(),$("#show_editMac").hide(),$("#show_IPAdr").show();var i=e.IPv4Address;document.getElementById("client_IPAdrReserve").value=e.ReserveIP,document.getElementById("client_MACAddress").innerHTML=e.MacAddress,$("#client_Name").val(e.NickName),""==i&&(i=I18N("j","Not Available")),$("#client_IPAdr").html(i),""==e.ReserveIP?(document.getElementById("show_IPAdrReserve").style.display="none",document.getElementById("show_IPAdr").style.display="table-row",$("#enableReserveIP").prop("checked",!1)):(document.getElementById("show_IPAdrReserve").style.display="table-row",document.getElementById("show_IPAdr").style.display="none",$("#enableReserveIP").prop("checked",!0)),""!=e.Vendor?document.getElementById("client_Vendor").innerHTML=e.Vendor:document.getElementById("client_Vendor").innerHTML="N/A",e.MacfilterEnabled?($("#schedule").selectbox("detach"),$("#schedule").val(e.ScheduleName),$("#schedule").selectbox("attach"),$("#enableAccess").prop("checked",!0),$("#show_Schedule").show()):($("#enableAccess").prop("checked",!1),$("#show_Schedule").hide()),$("#editPop").show()},i.prototype.showAddData=function(){changeTimeoutAction(),$("#popTitle").html(I18N("j","Add Rule")),$("#check_btn").attr("class","styled_button_dis").prop("disabled",!0),$("#show_Vendor").hide(),$("#client_MACAddress").hide(),$("#show_editMac").show(),$("#show_IPAdr").hide(),$("#show_IPAdrReserve").hide(),$("#enableReserveIP").prop("checked",!1),$("#enableAccess").prop("checked",!1),$("#show_Schedule").hide(),$("#editPop").show()},i.prototype.resetRulePOP=function(){t()},i.prototype.prepareUpdate=function(){for(var e in this.lineList){var i=this.lineList[e];for(var n in i.objList)i.objList[n].Live=!1}},i.prototype.clean=function(){var e=!1;for(var i in this.lineList){var n=this.lineList[i];for(var t in n.objList){var s=n.objList[t];0==s.Live&&(s.DOM.remove(),n.objList.splice(t,1),e=!0)}0==n.objList.length&&(n.DOM.remove(),this.lineList.splice(i,1),e=!0)}return e},i.prototype.refreshView=function(){for(var e in this.lineList)if(e!=this.lineList.length-1){var i=this.lineList[e];if(i.objList.length<i.MaxCount){var n=this.lineList[parseInt(e)+1];if(0<n.objList.length){var t=n.objList[0];i.objList.push(t),n.objList.splice(0,1),t.DOM.detach(),t.DOM.appendTo(i.DOM)}}}},$("#closeCreatePopBtn").off("click").click(function(){changeTimeoutAction(),t()}),i});