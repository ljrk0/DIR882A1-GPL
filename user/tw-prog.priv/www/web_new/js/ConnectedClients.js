/* svn info: $Revision: 1322 $ $Date: 2019-03-21 15:03:05 +0800 (Thu, 21 Mar 2019) $ */
function Datalist(){this.list=new Array,this.maxrowid=0;var e=new Data("","","","New","","","","","","");this.push(e)}function Data(e,t,i,n,a,s,l,d,r,o){this.MacAddress=e,this.IPv4Address=t,this.IPv6Address=i,this.Type=n,this.DeviceName=a,this.NickName=s,this.ReserveIP=l,this.State=o,this.Vendor=getVendor(e),this.ScheduleName="Always",this.MacfilterEnabled=!1,this.isAllowList=!1,this.isMacfilterEnabled=!0,this.Status=!1,this.ExtenderMacAddress=d,this.SignalStrength=r,this.Live=!0,this.ExtenderCard=!0}var tmpXML_ScheduleCnt;Datalist.prototype={get length(){return this.list.length},set length(e){0<=parseInt(e,10)&&(this.list.length=parseInt(e,10))},get extenderLength(){var e=0;for(var t in this.list)"WiFi_2.4G_MeshExtender"==this.list[t].Type&&e++;return e},get connectedLength(){var e=0,t=0,i=1;for(var n in this.list)"Blocked"==this.list[n].Type&&e++,"offline"==this.list[n].Type.toLowerCase()&&i++,"WiFi_2.4G_MeshExtender"==this.list[n].Type&&t++;return this.list.length-e-t-i}},Datalist.prototype.prepareUpdate=function(){for(var e in this.list)this.list[e].Live=!1},Datalist.prototype.getData=function(e){var t,i;for(t=0;t<this.list.length&&(i=this.list[t]).rowid!=e;t++);return i},Datalist.prototype.getDataRowNumByMac=function(e){var t,i=null,n=e.toLowerCase();for(t=0;t<this.list.length;t++)if(this.list[t].MacAddress.toLowerCase()==n){i=t;break}return i},Datalist.prototype.getRowNum=function(e){var t=0;for(t=0;t<this.list.length&&e!=this.list[t].rowid;t++);return t},Datalist.prototype.editData=function(e,t){var i=this.list[this.getRowNum(e)];return i.IPv4Address=t.IPv4Address,i.IPv6Address=t.IPv6Address,i.Type=t.Type,i.DeviceName=t.DeviceName,i.NickName=t.NickName,i.ReserveIP=t.ReserveIP,i.Vendor=t.Vendor,i.ScheduleName=t.ScheduleName,i.MacfilterEnabled=t.MacfilterEnabled,i.Status=t.Status,i.isAllowList=t.isAllowList,i.isMacfilterEnabled=t.isMacfilterEnabled,i.State=t.State,i.ExtenderMacAddress=t.ExtenderMacAddress,i.SignalStrength=t.SignalStrength,i.Live=!0},Datalist.prototype.deleteData=function(e){var t=this.getRowNum(e);this.list.splice(t,1)},Datalist.prototype.push=function(e){return e.setRowid(this.maxrowid),this.list.push(e),this.maxrowid++,this.list.sort(function(e,t){function i(e){return"LAN"==e?0:0<=e.toUpperCase().indexOf("WIFI_")?1:2}return i(e.Type)-i(t.Type)}),!0},Datalist.prototype.clean=function(){for(var e in this.list)obj=this.list[e],0==obj.Live&&this.list.splice(e,1)},Data.prototype={get NickName(){return""==this._NickName?this.DeviceName:this._NickName},set NickName(e){(this._NickName=e)==this.DeviceName&&(this._NickName="")},get ScheduleName(){return this._ScheduleName},set ScheduleName(e){""==e||"always"==e.toLowerCase()?this._ScheduleName="Always":this._ScheduleName=e},setRowid:function(e){this.rowid=e},showExtenderInfo:function(e){var t,i,n=this,a=n.NickName,s="link_IconE_Extender",l="",d={"COVR-C1200":"-32px","COVR-2200":"-64px","COVR-P2500":"-96px"};if(1==e?(t="",i="none",cardBgOne="extenderCardBg1",cardBgTwo="extenderCardBg2"):(t="none",i="",cardBgOne="extenderCardBg1 extenderCardBg1_2",cardBgTwo="extenderCardBg2 extenderCardBg2_2"),void 0===n.MacAddress||0==n.MacAddress.length)return"";""==a&&(a="Unknown");var r=parseInt(n.SignalStrength),o="color:#000";67<r?l="Excellent":r<=67&&33<r?l="Good":r<=33&&0<r?l="Weak":(l="Disconnect",o="color:#f00",s+="_Offline");var c=I18N("j","Remove"),u=I18N("j","Reboot"),h="0px";return null!=d[clearcode(n.DeviceName)]&&(h=d[clearcode(n.DeviceName)]),'<td><div class="extenderLargeCard"><div class="'+cardBgOne+'"></div><div class="'+cardBgTwo+'"></div><div id="extenderInfoCard'+n.rowid+'" class="client_Tag2" style="cursor:default; display:'+t+'"><div class="'+s+'" style="background-position-y:'+h+'"></div><div class="client_Info"><div class="client_EditImage" onclick="editExtenderData('+n.rowid+')" style="cursor:pointer"></div><div class="ExtenderCard_Settings"><div class="ExtenderCard_SettingsIMG" onclick="extenderCardChange(2,'+n.rowid+')" style="cursor:pointer"></div></div><div class="client_Name Extender">'+a+'</div><div class="client_ExtenderQulity">'+I18N("j","Quality")+': <div class="client_signalQulity '+l+'"></div><span style='+o+"> "+I18N("j",l)+'</span></div></div></div><div id="extenderSettingCard'+n.rowid+'" class = "client_Tag2" style="cursor:default; display:'+i+'"><div class="client_EditImage ExtenderReturn" onclick="extenderCardChange(1,'+n.rowid+')"></div><div id="check_btn_Reboot" class="styled_button_s ExtenderReboot" onclick="ExtenderReboot('+n.rowid+')">'+u+'</div><div id="check_btn_Remove" class="styled_button_s ExtenderRemove" onclick="ExtenderRemove('+n.rowid+')">'+c+"</div></div></div></td>"},showClientInfo:function(){var e,t=this,i=t.NickName,n="",a="link_IconE_",s="client_Name",l=t.IPv4Address,d=t.Vendor;if(void 0===t.MacAddress||0==t.MacAddress.length)return"";""==i&&(i="Unknown");var r=t.Type.toUpperCase();"WIFI_2.4G"==r||"WIFI_2.4G_GUEST"==r?a="link_IconW_":"WIFI_5G"==r||"WIFI_5G_GUEST"==r?a="link_IconW5G_":"WIFI_5G_2"==r||"WIFI_5G_2_GUEST"==r?a="link_IconW5G2_":"OFFLINE"==r&&(a="link_Offline_",s+=" client_Name_Offline",l=t.ReserveIP),t.MacfilterEnabled?(n=I18N("j","Enabled"),e="#FF0000"):(n=I18N("j","Disabled"),e="#000000"),"BLOCKED"==t.State?a+="Block":a+="Allow";var o='<td><div class ="client_Tag" style ="cursor:default"><div class ="'+a+'"></div><div class ="client_Info"><div class ="'+s+'">'+HTMLEncode(i)+"</div>";return t.Type.toUpperCase().indexOf("GUEST")<0&&(o+='<div class ="client_EditImage" onclick ="editData('+t.rowid+')" style ="cursor:pointer"></div>'),o+='<div class ="client_Vender" title="'+d+'" style="overflow:hidden;text-overflow:ellipsis;width:100px;white-space:nowrap;">'+d+'</div><div class ="client_IPv4Address">'+l+'</div><div class ="client_IPv6Address" id="IPv6Address_Client_'+t.rowid+'" title="'+t.IPv6Address+'">'+t.IPv6Address+"</div>",0==currentDevice.featureMcAfee&&"GUEST"!=r&&(o+='<div class ="client_Access">'+I18N("j","Parental Control")+': <font color ="'+e+'">'+n+"</font></div>"),o+="</div></div></td>"}};var Client_Type="Host",datalist=new Datalist,macList="",editType=!0,editID="";function LoadMACList(){$.ajax({url:"/js/MacList.json",type:"GET",dataType:"json",success:function(e){macList=e}})}function Base92(e){function t(e){return e+35==92?"!":String.fromCharCode(e+35)}var i=Math.floor(e/92),n=e%92,a="";return a+=92<=i?Base92(i):t(i),a+=t(n)}function getVendor(e){var t,i="Unknown Vendor";if(void 0===macList||""==macList)return i;try{var n=e.split(":"),a=Base92(parseInt(n[0],16)),s=Base92(parseInt(n[1]+n[2],16));void 0===(t=macList[a][s])&&(t=i)}catch(e){t=i}return decode_char_text(t)}function Get_ClientInfo(){var o=$.Deferred(),c=new SOAPGetClientInfoResponse,u=new SOAPGetMACFilters2Response,e=new SOAPAction,t=e.sendSOAPAction("GetClientInfo",null,c),i=null;return"clientInfo"==currentState&&(i=e.sendSOAPAction("GetMACFilters2",null,u)),$.when(t,i).done(function(e){for(var t in datalist.prepareUpdate(),datalist.list){"Blocked"!=(e=datalist.list[t]).Type&&"New"!=e.Type||(e.Live=!0)}for(var i in c.ClientInfoLists.ClientInfo){var n=c.ClientInfoLists.ClientInfo[i],a=new Data(n.MacAddress,n.IPv4Address,n.IPv6Address,n.Type,n.DeviceName,decode_char_text(n.NickName),n.ReserveIP,n.ExtenderMacAddress,n.SignalStrength,n.State);null!=(d=datalist.getDataRowNumByMac(n.MacAddress))?datalist.editData(datalist.list[d].rowid,a):datalist.push(a)}datalist.clean(),Remainingnumber=24;for(var s=0;s<datalist.list.length;s++){""!=datalist.list[s].ReserveIP&&Remainingnumber--}if(Remainingnumber<=0&&(Remainingnumber=0),$(".Remainingtext").find("span").text(Remainingnumber),"clientInfo"==currentState){for(var t in datalist.prepareUpdate(),datalist.list){"Blocked"!=(e=datalist.list[t]).Type&&(e.Live=!0)}for(var l in datalist.isAllowList=u.IsAllowList,u.MACList.MACInfo){var d,r=u.MACList.MACInfo[l];if(null!=(d=datalist.getDataRowNumByMac(r.MacAddress)))datalist.list[d].MacfilterEnabled=!0,datalist.list[d].ScheduleName=r.ScheduleName,datalist.list[d].Status=!0,datalist.list[d].Live=!0;else(a=new Data(r.MacAddress,"","","LAN",decode_char_text(r.DeviceName),"","","","")).MacfilterEnabled=!0,a.ScheduleName=r.ScheduleName,a.Type="OFFLINE",a.Status=!0,datalist.push(a),!0}datalist.clean(),showClientLists(Client_Type)}else getExtenderList();$("#Total_ConnectedClients").html(datalist.connectedLength),$("#Total_Extenders").html(datalist.extenderLength),null!=getClientInfo_timer&&(clearTimeout(getClientInfo_timer),getClientInfo_timer=setTimeout("Get_ClientInfo()",5e3)),o.resolve()}).fail(function(){null!=getClientInfo_timer&&(clearTimeout(getClientInfo_timer),getClientInfo_timer=setTimeout("Get_ClientInfo()",5e3))}),o.promise()}function getExtenderList(e){var t=0,i='<table class="block" border="0" ondragstart="return false" onselectstart="return false" width="900px"><tbody><tr>';for(var n in datalist.list){var a=datalist.list[n];e&&(a.ExtenderCard=!0),"WiFi_2.4G_MeshExtender"==a.Type&&(t++,i+=a.showExtenderInfo(a.ExtenderCard),t%3==0&&(i+="</tr><tr>"))}i+="</tr></tbody>",$("#Extender_Group").html(i),0<t?($("#Extender_NoDeviceInfo").hide(),$("#Extender_DeviceInfo").show()):($("#Extender_NoDeviceInfo").show(),$("#Extender_DeviceInfo").hide()),$("#Extender_Group").css("display","table-row")}function showClientLists(e){var t=0,i='<table class="block" border="0" ondragstart="return false" onselectstart="return false" width="900px"><tbody><tr>';for(var n in datalist.list){var a=datalist.list[n];if("WiFi_2.4G_MeshExtender"!=a.Type){if("Guest"==e){if(a.Type.toLowerCase().indexOf("guest")<0)continue}else if("Host"==e){if(0<=a.Type.toLowerCase().indexOf("guest"))continue;if("Blocked"==a.Type)continue;if("New"==a.Type)continue}else if("Blocked"==e&&"Blocked"!=a.Type)continue;t++,i+=a.showClientInfo(),t%3==0&&(i+="</tr><tr>")}}var s='<td><div class ="client_add_Tag" onclick ="addData()" style ="cursor:pointer;';s+="Host"==Client_Type?"display:block;":"display:none;",i+=s+='"></div></td>',++t%3==0&&(i+="</tr><tr>"),i+="</tr></tbody></table>",$("#Client_Group").html(i),0<t?$("#Client_Info").hide():"Blocked"==e||$("#Client_Info").show(),$("#Client_Group").css("display","table-row")}function addData(){clearTimeout(getClientInfo_timer),getClientInfo_timer=null,changeTimeoutAction(),$("#popTitle").html(I18N("j","Add Rule")),$("#check_btn").attr("class","styled_button_dis").prop("disabled",!0),$("#show_Vendor").hide(),$("#client_MACAddress").hide(),$("#show_editMac").show(),$("#show_IPAdr").hide(),"Guest"==Client_Type?$("#show_ReserveIP").hide():$("#show_ReserveIP").show(),$("#show_IPAdrReserve").hide(),$("#enableReserveIP").prop("checked",!1),Remainingnumber<=0?$("#enableReserveIP").attr("disabled",!0):$("#enableReserveIP").attr("disabled",!1),$("#enableAccess").prop("checked",!1),$("#show_Schedule").hide(),$("#editPop").show(),editType=!1,editID=""}function editData(e){clearTimeout(getClientInfo_timer),getClientInfo_timer=null,changeTimeoutAction(),$("#check_btn").attr("class","styled_button_dis").prop("disabled",!0),$("#popTitle").html(I18N("j","Edit Rule")),$("#show_Vendor").show(),$("#client_MACAddress").show(),$("#show_editMac").hide(),$("#show_IPAdr").show();var t=datalist.getData(e),i=t.IPv4Address;document.getElementById("client_IPAdrReserve").value=t.ReserveIP,document.getElementById("client_MACAddress").innerHTML=t.MacAddress,$("#client_Name").val(t.NickName),""==i&&(i=I18N("j","Not Available")),$("#client_IPAdr").html(i),"Guest"==Client_Type?(t.ReserveIP="",$("#show_ReserveIP").hide()):$("#show_ReserveIP").show(),""==t.ReserveIP?(document.getElementById("show_IPAdrReserve").style.display="none",document.getElementById("show_IPAdr").style.display="table-row",$("#enableReserveIP").prop("checked",!1)):(document.getElementById("show_IPAdrReserve").style.display="table-row",document.getElementById("show_IPAdr").style.display="none",$("#enableReserveIP").prop("checked",!0)),Remainingnumber<=0?$("#enableReserveIP").is(":checked")?$("#enableReserveIP").attr("disabled",!1):$("#enableReserveIP").attr("disabled",!0):$("#enableReserveIP").attr("disabled",!1),""!=t.Vendor?document.getElementById("client_Vendor").innerHTML=t.Vendor:document.getElementById("client_Vendor").innerHTML="N/A",t.MacfilterEnabled?($("#schedule").selectbox("detach"),$("#schedule").val(t.ScheduleName),$("#schedule").selectbox("attach"),$("#enableAccess").prop("checked",!0),$("#show_Schedule").show()):($("#schedule").selectbox("detach"),$("#schedule").val("Always"),$("#schedule").selectbox("attach"),$("#enableAccess").prop("checked",!1),$("#show_Schedule").hide()),$("#editPop").show(),editType=!0,editID=e}function closeEditPOP(){changeTimeoutAction();var e=$("#enableReserveIP").prop("checked"),t=$("#client_IPAdrReserve").val(),i=$("#client_Name").val(),n=$("#enableAccess").prop("checked"),a=$("#schedule").val();$("#check_btn").attr("class","styled_button_dis").prop("disabled",!0);var s=datalist.getData(editID);s.NickName=i,s.ReserveIP=e&&""!=t?t:"",s.MacfilterEnabled=n,s.isAllowList=datalist.isAllowList,s.ScheduleName=n?a:"",datalist.editData(s.rowid,s);var l=new SOAPAction,d=new SOAPSetClientInfo,r=new SOAPClientInfo;r.MacAddress=s.MacAddress,r.NickName=encode_char_text(s.NickName),r.ReserveIP=s.ReserveIP,d.ClientInfoLists.push(r),l.sendSOAPAction("SetClientInfo",d,null).done(function(e){if("ERROR_RESERVEIP_CONFLICT"==e.SetClientInfoResult)alert(I18N("j","IP address cannot be the same.")),$("#check_btn").attr("class","styled_button_s").prop("disabled",!1);else{var t=new SOAPAction,i=new SOAPSetMACFilters2;for(var n in i.IsAllowList=datalist.isAllowList,datalist.list)if(datalist.list[n].MacfilterEnabled&&"New"!=datalist.list[n].Type){var a=new SOAPMacInfo;a.DeviceName=encode_char_text(datalist.list[n].NickName),a.MacAddress=datalist.list[n].MacAddress,a.ScheduleName=datalist.list[n].ScheduleName,i.MACList.push(a)}t.sendSOAPAction("SetMACFilters2",i,null).always(function(){resetRulePOP("Client")})}}).fail(function(){resetRulePOP("Client")})}function closeAddPOP(){changeTimeoutAction();var e=$("#enableReserveIP").prop("checked"),t=$("#client_IPAdrReserve").val(),i=$("#client_Name").val(),n=$("#enableAccess").prop("checked"),a=$("#schedule").val(),s=$("#client_editMac").val();$("#check_btn").attr("class","styled_button_dis").prop("disabled",!0);var l=new SOAPAction,d=null,r=null;if(e){var o=new SOAPSetClientInfo;(h=new SOAPClientInfo).MacAddress=s,h.NickName=encode_char_text(i),h.ReserveIP=t,o.ClientInfoLists.push(h),(d=l.sendSOAPAction("SetClientInfo",o,null)).done(function(e){"ERROR_RESERVEIP_CONFLICT"==e.SetClientInfoResult&&(alert(I18N("j","IP address cannot be the same.")),$("#check_btn").attr("class","styled_button_s").prop("disabled",!1))})}if(n){var c=new SOAPSetMACFilters2;for(var u in c.IsAllowList=datalist.isAllowList,datalist.list){var h;if(datalist.list[u].MacfilterEnabled&&"New"!=datalist.list[u].Type)(h=new SOAPMacInfo).DeviceName=datalist.list[u].DeviceName,h.MacAddress=datalist.list[u].MacAddress,h.ScheduleName=encode_char_text(datalist.list[u].ScheduleName),c.MACList.push(h)}var v=new SOAPMacInfo;v.DeviceName=encode_char_text(i),v.MacAddress=s,v.ScheduleName=encode_char_text(a),c.MACList.push(v),r=l.sendSOAPAction("SetMACFilters2",c,null)}$.when(d,r).always(function(e){resetRulePOP("Client")})}function editExtenderData(e){clearTimeout(getClientInfo_timer),getClientInfo_timer=null,changeTimeoutAction();var t=datalist.getData(e);$("#check_btn_Extender").attr("class","styled_button_dis").prop("disabled",!0),$("#Extender_Name").val(t.NickName),$("#Extender_MACAddress").html(t.MacAddress),$("#editExtenderPop").show(),editID=e}function clearExtenderRulePOP(){changeTimeoutAction(),resetRulePOP("Extender")}function saveEditExtenderPOP(){changeTimeoutAction();I18N("j","Your changes are being saved, please wait..."),I18N("j","The new settings have been saved.");$("#check_btn_Extender").attr("class","styled_button_dis").prop("disabled",!0);var e=$("#Extender_Name").val(),t=datalist.getData(editID);t.NickName=e;var i=new SOAPAction,n=new SOAPSetClientInfo,a=new SOAPClientInfo;a.MacAddress=t.MacAddress,a.NickName=encode_char_text(t.NickName),a.ReserveIP=t.ReserveIP,n.ClientInfoLists.push(a),i.sendSOAPAction("SetClientInfo",n,null).done(function(e){resetRulePOP("Extender")})}function ExtenderRemove(e){clearTimeout(getClientInfo_timer),getClientInfo_timer=null;var t=new SOAPAction2,i=datalist.getData(e),n=[];n.push(i.MacAddress);var a=I18N("j","Are you sure you want to reset the device to its factory default settings? This will cause current settings to be lost.");PopView.showDialog(a,!0).done(function(){extenderCardChange(1,e),t.sendSOAPAction("SetFactoryDefault",null,null,n).done(function(){"OK"!=obj.SetFactoryDefaultResult&&"REBOOT"!=obj.SetFactoryDefaultResult&&"RESTART"!=obj.SetFactoryDefaultResult||resetRulePOP("Extender")}),PopView.hide()}).fail(function(){PopView.hide()})}function ExtenderReboot(e){clearTimeout(getClientInfo_timer),getClientInfo_timer=null;var t=new SOAPAction2,i=datalist.getData(e),n=[];n.push(i.MacAddress);var a=I18N("j","Are you sure you want to restart the device?");PopView.showDialog(a,!0).done(function(){extenderCardChange(1,e),t.sendSOAPAction("Reboot",null,null,n).done(function(e){"OK"!=e.RebootResult&&"REBOOT"!=e.RebootResult&&"RESTART"!=e.RebootResult||resetRulePOP("Extender")}),PopView.hide()}).fail(function(){PopView.hide()})}function closeCreatePopMessage(){changeTimeoutAction(),$("#CreatePopAlertMessage").hide(),$("#REBOOTCheck").hide(),$("#REBOOT").hide(),$("#SuccessREBOOT").hide(),$("#FACTORYDEFAULTCheck").hide(),$("#FACTORYDEFAULT").hide(),$("SuccessFACTORYDEFAULT").hide()}function extenderCardChange(e,t){changeTimeoutAction(),clearTimeout(getClientInfo_timer),getClientInfo_timer=null;var i="#extenderInfoCard"+t,n="#extenderSettingCard"+t,a=datalist.getData(t);1==e?($(i).closest(".extenderLargeCard").find(".extenderCardBg1").addClass("extenderCardTransition").removeClass("extenderCardBg1_2"),$(n).closest(".extenderLargeCard").find(".extenderCardBg2").addClass("extenderCardTransition").removeClass("extenderCardBg2_2"),$(i).delay(500).fadeIn(100),$(n).hide(),a.ExtenderCard=!0):($(i).hide(),$(n).delay(500).fadeIn(100),$(i).closest(".extenderLargeCard").find(".extenderCardBg1").addClass("extenderCardTransition").addClass("extenderCardBg1_2"),$(n).closest(".extenderLargeCard").find(".extenderCardBg2").addClass("extenderCardTransition").addClass("extenderCardBg2_2"),a.ExtenderCard=!1),setTimeout(function(){null==getClientInfo_timer&&(getClientInfo_timer=setTimeout("Get_ClientInfo()",5e3))},1e3)}function popDiagnosticsMSG(){PopView.showWarningMSG("title","content").done(function(){PopView.hide()})}function clearCreateRulePOP(){changeTimeoutAction(),resetRulePOP("Client")}function resetRulePOP(e){Get_ClientInfo().always(function(){"Client"==e?($("#editPop").hide(),$("input").val(""),$("#editMac_Info").hide(),$("select").selectbox("detach"),$("#schedule").val("Always"),$("select").selectbox("attach"),$("#client_IPAdrReserve_warning").remove(),$("#client_form").validate().resetForm(),$("#client_form input").removeClass("error")):($("input").val(""),$("#editExtenderPop").hide())}),null==getClientInfo_timer&&(getClientInfo_timer=setTimeout("Get_ClientInfo()",5e3))}function getClientList(e){"Host"==e?($("#client_btn_Blocked").attr("class","v4v6_linkstyle_2"),$("#client_btn_Guest").attr("class","v4v6_linkstyle_2"),$("#client_btn_Host").attr("class","v4v6_linkstyle_1"),$(".client_add_Tag").show()):"Guest"==e?($("#client_btn_Blocked").attr("class","v4v6_linkstyle_2"),$("#client_btn_Guest").attr("class","v4v6_linkstyle_1"),$("#client_btn_Host").attr("class","v4v6_linkstyle_2"),$(".client_add_Tag").hide()):($("#client_btn_Blocked").attr("class","v4v6_linkstyle_1"),$("#client_btn_Guest").attr("class","v4v6_linkstyle_2"),$("#client_btn_Host").attr("class","v4v6_linkstyle_2")),Client_Type=e,Get_ClientInfo()}function buttonStyleChange(){var e=!0;changeTimeoutAction(),1==editType||(""==$("#client_editMac").val()&&(e=!1),0==$("#enableReserveIP").prop("checked")&&0==$("#enableAccess").prop("checked")&&(e=!1)),1==$("#enableReserveIP").prop("checked")&&""==$("#client_IPAdrReserve").val()&&(e=!1),e?$("#check_btn").attr("class","styled_button_s").prop("disabled",!1):$("#check_btn").attr("class","styled_button_dis").prop("disabled",!0)}function setEvents(){$("#enableReserveIP").on("change",function(e){buttonStyleChange(),$(this).prop("checked")?$("#show_IPAdrReserve").show():$("#show_IPAdrReserve").hide()}),$("#enableAccess").on("change",function(e){buttonStyleChange(),$(this).prop("checked")?$("#show_Schedule").show():$("#show_Schedule").hide()})}function setClientValidate(){$.validator.addMethod("checkIP",function(e,t){return""==e||!(!COMM_ValidV4Format(e)||!COMM_ValidV4Addr(e))},jQuery.validator.messages.address_Check),$.validator.addMethod("checkMac",function(e,t){return 0!=COMM_IsMAC(e)&&("00:00:00:00:00:00"!=e&&"FF:FF:FF:FF:FF:FF"!=e.toUpperCase())},jQuery.validator.messages.mac_Check),$.validator.addMethod("checkMacConflict",function(e,t){for(var i in datalist.list){var n=datalist.list[i];if(e=e.replace(/-/g,":"),n.MacAddress.toLowerCase()==e.toLowerCase())return!1}return!0},jQuery.validator.messages.mac_Conflict),$.validator.addMethod("checkIPConflict",function(e,t){for(var i in datalist.list){var n=datalist.list[i];if((1!=editType||editID!=n.rowid)&&(""!=e&&n.ReserveIP==e))return!1}return!0},jQuery.validator.messages.ip_Conflict),$.validator.addMethod("checkDHCPServerEnabled",function(e,t){var i=!0;return"false"==getRouterLanSettingsResponse.DHCPServerEnabled&&(i=!1),i},I18N("j","Please Enable DHCP Server first.")),$.validator.addMethod("checkDHCPrange",function(e,t){var i=!0,n=e.split("."),a=getNetworkSettings.IPAddress.split("."),s=getRouterLanSettingsResponse.DHCPServerEnabled,l=parseInt(getNetworkSettings.IPRangeStart,10),d=parseInt(getNetworkSettings.IPRangeEnd,10);return"true"==s&&(n[0]!=a[0]||n[1]!=a[1]||n[2]!=a[2]?i=!1:(parseInt(n[3],10)<l||parseInt(n[3],10)>d)&&(i=!1)),i},I18N("j","Reserved IP address should be within the configured DHCP range.")),$.validator.addMethod("checklanip",function(e,t){return""==getRouterLanSettingsResponse.RouterIPAddress||e!=getRouterLanSettingsResponse.RouterIPAddress},I18N("j","err_address_Check")),$.validator.addMethod("trimWhiteSpace",function(e,t){var i=!0;return e!=e.trim()&&(i=!1),i},I18N("j","Invalid %s. Only A-Z, a-z, 0-9, “-”, “_”, and spaces are allowed.",I18N("j","Name"))),$.validator.addMethod("checkGenName",function(e,t){var i=!0;return""!=e&&(i=COMM_ValidName(e)),i},I18N("j","Invalid %s. Only A-Z, a-z, 0-9, “-”, “_”, and spaces are allowed.",I18N("j","Name"))),$("#client_form").validate({rules:{client_Name:{trimWhiteSpace:!0,checkGenName:!0},client_editMac:{checkMac:!0,checkMacConflict:!0},client_IPAdrReserve:{checkIP:!0,checkIPConflict:!0,checkDHCPServerEnabled:!0,checkDHCPrange:!0,checklanip:!0}},submitHandler:function(e){1==editType?closeEditPOP():closeAddPOP()},unhighlight:function(e,t,i){if($(e).removeClass(t).addClass(i),e==$("input#client_IPAdrReserve")[0]&&1==editType){$("#client_IPAdrReserve_warning").remove();var n=datalist.getData(editID);e.value&&e.value!=n.ReserveIP&&($(e).after("<div id='client_IPAdrReserve_warning' style='color:#00f;fone-size:12px' />"),$("#client_IPAdrReserve_warning").html(I18N("j","It will take effect after reconnecting")))}},highlight:function(e,t,i){$(e).addClass(t).removeClass(i),e==$("input#client_IPAdrReserve")[0]&&$("#client_IPAdrReserve_warning").remove()},errorPlacement:function(e,t){e.insertAfter(t).css("display","inline")}}),$("#extender_form").validate({rules:{Extender_Name:{trimWhiteSpace:!0,checkGenName:!0}},submitHandler:function(e){saveEditExtenderPOP()}})}