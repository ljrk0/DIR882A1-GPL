/* svn info: $Revision: 847 $ $Date: 2018-06-06 18:37:11 +0800 (Wed, 06 Jun 2018) $ */
function Datalist(){this.list=new Array,this.maxrowid=0}function Data(t,e,o,i,s,r,a){var l=parseInt(s,10),n=parseInt(r,10);this.name=t,this.ipAddress=e,this.externalPort=isNaN(l)?"":l,this.internalPort=isNaN(n)?"":n,""==a||"always"==a.toLowerCase()?this.schedule="Always":this.schedule=a,this.setEnable("true"),this.setProtocol(o,i)}Datalist.prototype.getData=function(t){var e,o;for(e=0;e<this.list.length&&(o=this.list[e]).rowid!=t;e++);return o},Datalist.prototype.getRowNum=function(t){var e=0;for(e=0;e<this.list.length&&t!=this.list[e].rowid;e++);return e},Datalist.prototype.editData=function(t,e){var o=this.getRowNum(t);return 0!=this.checkData(e,o)&&(e.setRowid(t),this.list.splice(o,1,e),e.setDataToRow($("#tr"+e.rowid)),!0)},Datalist.prototype.deleteData=function(t){var e=this.getRowNum(t);this.list.splice(e,1),$("#tr"+t).remove()},Datalist.prototype.push=function(t){return 0!=this.checkData(t,null)&&(t.setRowid(this.maxrowid),this.list.push(t),this.maxrowid++,t.addRowToHTML("tblVirtualServer"),!0)},Datalist.prototype.checkData=function(t,e){var o;for(o=0;o<this.list.length;o++)if(o!=e){if(this.list[o].name==t.name)return alert(I18N("j","Name cannot be the same.")),!1;if((this.list[o].protocol==t.protocol||"Both"==this.list[o].protocol||"Both"==t.protocol)&&this.list[o].externalPort==t.externalPort&&this.list[o].internalPort==t.internalPort&&this.list[o].schedule==t.schedule)return alert(I18N("j","Rule cannot be the same.")),!1}return!0},Datalist.prototype.length=function(){return this.list.length},Data.prototype={rowid:null,enable:null,name:null,ipAddress:null,protocol:null,protocolNum:null,externalPort:null,internalPort:null,schedule:null,setRowid:function(t){this.rowid=t},setEnable:function(t){this.enable=t},setProtocol:function(t,e){switch(this.protocolNum=e){case"6":this.protocol="TCP";break;case"17":this.protocol="UDP";break;case"256":this.protocol="Both";break;default:this.protocol="Other",this.protocolNum=e}},showEnable:function(){var t="",e="true";return"true"==this.enable&&(t="checked",e="false"),'<input type="checkbox" onChange="datalist.list['+this.rowid+"].setEnable('"+e+"')\" "+t+"/>"},showName:function(){return HTMLEncode(this.name)},showExternalPort:function(){return this.externalPort},showInternalPort:function(){return this.internalPort},showSchedule:function(){return"Always"==this.schedule||""==this.schedule?I18N("j","Always"):AllEncode(decode_char_text(this.schedule))},addRowToHTML:function(t){var e;e="<tr id='tr"+this.rowid+"'></tr>",$("#"+t+"> tbody").append(e),this.setDataToRow($("#tr"+this.rowid))},setDataToRow:function(t){var e;e="<td>"+this.showEnable()+"</td>",e+="<td>"+this.showName()+"</td>",e+="<td>"+this.ipAddress+"</td>",e+="<td>"+this.protocol+"</td>",e+="<td>"+this.showExternalPort()+"</td>",e+="<td>"+this.showInternalPort()+"</td>",e+="<td>"+this.showSchedule()+"</td>",e+="<td><img src='image/edit_btn.png?v=2fc10c4616' width=28 height=28 style='cursor:pointer' onclick='editData("+this.rowid+")'/></td>",e+="<td><img src='image/trash.png?v=8fee37bb10' width=41 height=41 style='cursor:pointer' onclick='deleteData("+this.rowid+")'/></td>",t.html(e)}};