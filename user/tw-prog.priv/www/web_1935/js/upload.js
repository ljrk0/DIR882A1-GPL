/* svn info: $Revision: 847 $ $Date: 2018-06-06 18:37:11 +0800 (Wed, 06 Jun 2018) $ */
var SOAP_NAMESPACE="http://purenetworks.com/HNAP1/",currentFile=null;function prepareUpload(e){if(void 0!==e.target){var r=e.target.files;currentFile=r[0]}return currentFile}function uploadFile(r,t,a){var o=$.Deferred(),e=new FileReader;return e.onload=function(e){upload(r,t,e.target.result,a,0).done(function(){o.resolve()}).fail(function(){o.reject()})},e.readAsArrayBuffer(a),o.promise()}function upload(e,r,t,a,o){var n=$.Deferred(),i=new Blob([t]),s=new FormData,u={};s.append(r,i,a.name);var c='"'+SOAP_NAMESPACE+e+'"';u={SOAPAction:c};var l=sessionStorage.getItem("PrivateKey");if(null!=l){var p=sessionStorage.getItem("Cookie");$.cookie("uid",p,{expires:1,path:"/"});var d=(new Date).getTime();d=(d=Math.floor(d)%2e12).toString();var f=hex_hmac_md5(l,d+c);f=f.toUpperCase()+" "+d,u.HNAP_AUTH=f}return $.ajax({url:"/HNAP1/",type:"POST",data:s,cache:!1,processData:!1,headers:u,contentType:!1,success:function(e,r,t){void 0===e.error?n.resolve():n.reject()},error:function(e,r,t){401==e.status&&location.assign("/"),n.reject()}}),n.promise()}