/* svn info: $Revision: 1011 $ $Date: 2018-08-08 11:27:52 +0800 (Wed, 08 Aug 2018) $ */
var getDeviceSettings=new SOAPGetDeviceSettingsResponse,deviceinfo_type={};function ModelInfo(e,r,t){this.modelName=e,this.hwVer=r,this.fwVer=t}function getDeviceInfo(){var n=$.Deferred();return(new SOAPAction).sendSOAPAction("GetDeviceSettings",null,getDeviceSettings).done(function(e){var r=e.LatestFirmwareVersion;""!=r&&"."!=r||(r=0);var t=new ModelInfo(e.ModelName,e.HardwareVersion,e.FirmwareVersion);sessionStorage.setItem("modelInfomation",JSON.stringify(t)),sessionStorage.setItem("currentFWVersion",e.FirmwareVersion),sessionStorage.setItem("newFWVersion",r),sessionStorage.setItem("FWRegion",e.FirmwareRegion),sessionStorage.setItem("RequireLevel",e.RequireLevel);var i=e.Type?e.Type:"WirelessRouter";sessionStorage.setItem("currentMode",i),e.SupportMyDLinkAbilities&&0<=e.SupportMyDLinkAbilities.toLowerCase().indexOf("gen2")&&0<=e.SupportMyDLinkAbilities.toLowerCase().indexOf("mcafee")?sessionStorage.setItem("McAfee",!0):sessionStorage.setItem("McAfee",!1),n.resolve()}).fail(function(){n.reject()}),n.promise()}function setLang(){var e=new Array("en-us","zh-tw","zh-cn","ko-kr","fr-fr","pt-br","es-es","it-it","de-de","ru-ru");try{var r=localStorage.getItem("language");if(null==r){r="en-us";var t=null;t=(t="Netscape"==navigator.appName?navigator.language:navigator.browserLanguage).toLowerCase();for(var i=0;i<e.length;i++)t==e[i]&&(r=t);localStorage.setItem("language",r)}InitLANG(r)}catch(e){throw e.code===DOMException.QUOTA_EXCEEDED_ERR&&0===localStorage.length&&alert(I18N("j","The Private Browsing feature of Safari is incompatible with this device's interface. You will need to disable Private Browsing to log in.")),e}}function detectBrowserVersion(){var e=$.client.browser,r=parseInt($.client.version);"Mozilla"==e&&"11"==r&&(e="Explorer");var t=!0;switch(e){case"Chrome":r<28&&(t=!1);break;case"Explorer":r<10&&(t=!1);break;case"Edge":r<12&&(t=!1);break;case"Safari":r<6&&(t=!1);break;case"Firefox":r<28&&(t=!1)}return t}function initEnv(){var e=$.Deferred();if(!detectBrowserVersion())return alert(I18N("j","The system doesn't support your browser.")),e.reject();var r=getDeviceInfo();return $.when(r).done(function(){e.resolve()}).fail(function(){e.reject()}),setLang(),e.promise()}function deviceinfoConfig(){var r=$.Deferred();return $.getScript("/config/deviceinfo.js?v=6d45a98b51",function(){DeviceInfo.prototype=new CommonDeviceInfo;var e=new DeviceInfo;deviceinfo_type=new DeviceInfo,sessionStorage.setItem("currentDevice",$.stringify(e)),r.resolve()}),r.promise()}