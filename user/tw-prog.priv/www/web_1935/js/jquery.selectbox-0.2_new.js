/* svn info: $Revision: 884 $ $Date: 2018-06-19 15:26:33 +0800 (Tue, 19 Jun 2018) $ */
/*!
 * jQuery Selectbox plugin 0.2
 *
 * Copyright 2011-2012, Dimitar Ivanov (http://www.bulgaria-web-developers.com/projects/javascript/selectbox/)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 * 
 * Date: Tue Jul 17 19:58:36 2012 +0300
 */
!function(h,s){var f="selectbox",l=!1;function e(){this._state=[],this._defaults={classHolder:"sbHolder",classHolderDisabled:"sbHolderDisabled",classSelector:"sbSelector",classOptions:"sbOptions",classGroup:"sbGroup",classSub:"sbSub",classDisabled:"sbDisabled",classToggleOpen:"sbToggleOpen",classToggle:"sbToggle",classFocus:"sbFocus",width:220,speed:100,effect:"slide",onChange:null,onOpen:null,onClose:null}}h.extend(e.prototype,{_isOpenSelectbox:function(s){return s?this._getInst(s).isOpen:l},_isDisabledSelectbox:function(s){return s?this._getInst(s).isDisabled:l},_attachSelectbox:function(o,s){if(this._getInst(o))return l;var e,c,d,r,t=h(o),u=this,p=u._newInst(t),b=l,i=(t.find("optgroup"),t.find("option")),g=i.length;function n(){var s,e,t=this.attr("id").split("_")[1];for(s in u._state)s!==t&&u._state.hasOwnProperty(s)&&(e=h("select[sb='"+s+"']")[0])&&u._closeSelectbox(e)}function a(){var n=!(!arguments[1]||!arguments[1].sub),a=!(!arguments[1]||!arguments[1].disabled),l="";arguments[0].each(function(s){var e,t=h(this),i=h("<li>");l=-1<t.closest("select").attr("id").toLowerCase().indexOf("schedule")||-1<t.closest("select").attr("id").toLowerCase().indexOf("timezone")?t.text():I18N("j",t.text()),t.is(":selected")&&(c.text(l),b=!0),s===g-1&&i.addClass("last"),t.is(":disabled")||a||"none"==t.css("display")?"none"==t.css("display")||(e=h("<span>",{text:l}).addClass(p.settings.classDisabled),n&&e.addClass(p.settings.classSub),e.appendTo(i)):(e=h("<a>",{href:""+t.val(),rel:t.val()}).text(l).bind("click.sb",function(s){s&&s.preventDefault&&s.preventDefault();var e=d,t=h(this);e.attr("id").split("_")[1];u._changeSelectbox(o,t.attr("rel"),l),u._closeSelectbox(o)}).bind("mouseover.sb",function(){var s=h(this);s.parent().siblings().find("a").removeClass(p.settings.classFocus),s.addClass(p.settings.classFocus)}).bind("mouseout.sb",function(){h(this).removeClass(p.settings.classFocus)}),n&&e.addClass(p.settings.classSub),t.is(":selected")&&e.addClass(p.settings.classFocus),e.appendTo(i)),i.appendTo(r)})}t.attr("sb",p.uid),h.extend(p.settings,u._defaults,s),u._state[p.uid]=l,t.hide(),e=h("<div>",{id:"sbHolder_"+p.uid,class:p.settings.classHolder,style:"width:"+p.settings.width+"px",tabindex:t.attr("tabindex")}),c=h("<a>",{id:"sbSelector_"+p.uid,href:"#",class:p.settings.classSelector,style:"width:"+(p.settings.width-30)+"px",click:function(s){s.preventDefault(),n.apply(h(this),[]);var e=h(this).attr("id").split("_")[1];u._state[e]?u._closeSelectbox(o):u._openSelectbox(o)}}),(d=h("<a>",{id:"sbToggle_"+p.uid,href:"#",class:p.settings.classToggle,click:function(s){s.preventDefault(),n.apply(h(this),[]);var e=h(this).attr("id").split("_")[1];u._state[e]?u._closeSelectbox(o):u._openSelectbox(o)}})).appendTo(e),r=h("<ul>",{id:"sbOptions_"+p.uid,class:p.settings.classOptions,style:"width:"+p.settings.width+"px",css:{display:"none"}}),t.children().each(function(s){var e,t=h(this),i={};t.is("option")?a(t):t.is("optgroup")&&(e=h("<li>"),h("<span>",{text:t.attr("label")}).addClass(p.settings.classGroup).appendTo(e),e.appendTo(r),t.is(":disabled")&&(i.disabled=!0),i.sub=!0,a(t.find("option"),i))}),b||c.text(i.first().text()),h.data(o,f,p),e.data("uid",p.uid).bind("keydown.sb",function(s){var e=s.charCode?s.charCode:s.keyCode?s.keyCode:0,t=h(this),i=t.data("uid"),n=t.siblings("select[sb='"+i+"']").data(f),a=t.siblings(["select[sb='",i,"']"].join("")).get(0),l=t.find("ul").find("a."+n.settings.classFocus);switch(e){case 37:case 38:if(0<l.length)h("a",t).removeClass(n.settings.classFocus),0<(o=l.parent().prevAll("li:has(a)").eq(0).find("a")).length&&(o.addClass(n.settings.classFocus).focus(),h("#sbSelector_"+i).text(o.text()));break;case 39:case 40:var o;h("a",t).removeClass(n.settings.classFocus),0<(o=0<l.length?l.parent().nextAll("li:has(a)").eq(0).find("a"):t.find("ul").find("a").eq(0)).length&&(o.addClass(n.settings.classFocus).focus(),h("#sbSelector_"+i).text(o.text()));break;case 13:0<l.length&&u._changeSelectbox(a,l.attr("rel"),l.text()),u._closeSelectbox(a);break;case 9:if(a)(n=u._getInst(a))&&(0<l.length&&u._changeSelectbox(a,l.attr("rel"),l.text()),u._closeSelectbox(a));var c=parseInt(t.attr("tabindex"),10);s.shiftKey?c--:c++,h("*[tabindex='"+c+"']").focus();break;case 27:u._closeSelectbox(a)}return s.stopPropagation(),!1}).delegate("a","mouseover",function(s){h(this).addClass(p.settings.classFocus)}).delegate("a","mouseout",function(s){h(this).removeClass(p.settings.classFocus)}),c.appendTo(e),r.appendTo(e),e.insertAfter(t),h("html").on("mousedown",function(s){s.stopPropagation(),h("select").selectbox("close")}),h([".",p.settings.classHolder,", .",p.settings.classSelector].join("")).mousedown(function(s){s.stopPropagation()})},_detachSelectbox:function(s){var e=this._getInst(s);if(!e)return l;h("#sbHolder_"+e.uid).remove(),h.data(s,f,null),h(s).show()},_changeSelectbox:function(s,e,t){var i,n=this._getInst(s);n&&(i=this._get(n,"onChange"),h("#sbSelector_"+n.uid).text(t)),e=e.replace(/\'/g,"\\'"),h(s).find("option[value='"+e+"']").prop("selected",!0),n&&i?i.apply(n.input?n.input[0]:null,[e,n]):n&&n.input&&n.input.trigger("change")},_enableSelectbox:function(s){var e=this._getInst(s);if(!e||!e.isDisabled)return l;h("#sbHolder_"+e.uid).removeClass(e.settings.classHolderDisabled),e.isDisabled=l,h.data(s,f,e)},_disableSelectbox:function(s){var e=this._getInst(s);if(!e||e.isDisabled)return l;h("#sbHolder_"+e.uid).addClass(e.settings.classHolderDisabled),e.isDisabled=!0,h.data(s,f,e)},_optionSelectbox:function(s,e,t){var i=this._getInst(s);if(!i)return l;i[e]=t,h.data(s,f,i)},_openSelectbox:function(s){var e=this._getInst(s);if(e&&!e.isOpen&&!e.isDisabled){var t=h("#sbOptions_"+e.uid),i=parseInt(h(window).height(),10),n=h("#sbHolder_"+e.uid).offset(),a=h(window).scrollTop(),l=t.prev().height(),o=i-(n.top-a)-l/2,c=this._get(e,"onOpen");t.css({top:l+"px",maxHeight:o-l+"px"}),"fade"===e.settings.effect?t.fadeIn(e.settings.speed):t.slideDown(e.settings.speed),h("#sbToggle_"+e.uid).addClass(e.settings.classToggleOpen),this._state[e.uid]=!0,e.isOpen=!0,c&&c.apply(e.input?e.input[0]:null,[e]),h.data(s,f,e)}},_closeSelectbox:function(s){var e=this._getInst(s);if(e&&e.isOpen){var t=this._get(e,"onClose");"fade"===e.settings.effect?h("#sbOptions_"+e.uid).fadeOut(e.settings.speed):h("#sbOptions_"+e.uid).slideUp(e.settings.speed),h("#sbToggle_"+e.uid).removeClass(e.settings.classToggleOpen),this._state[e.uid]=l,e.isOpen=l,t&&t.apply(e.input?e.input[0]:null,[e]),h.data(s,f,e)}},_newInst:function(s){return{id:s[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:s,uid:Math.floor(99999999*Math.random()),isOpen:l,isDisabled:l,settings:{}}},_getInst:function(s){try{return h.data(s,f)}catch(s){throw"Missing instance data for this selectbox"}},_get:function(s,e){return void 0!==s.settings[e]?s.settings[e]:this._defaults[e]}}),h.fn.selectbox=function(s){var e=Array.prototype.slice.call(arguments,1);return"string"==typeof s&&"isDisabled"==s?h.selectbox["_"+s+"Selectbox"].apply(h.selectbox,[this[0]].concat(e)):"option"==s&&2==arguments.length&&"string"==typeof arguments[1]?h.selectbox["_"+s+"Selectbox"].apply(h.selectbox,[this[0]].concat(e)):this.each(function(){"string"==typeof s?h.selectbox["_"+s+"Selectbox"].apply(h.selectbox,[this].concat(e)):h.selectbox._attachSelectbox(this,s)})},h.selectbox=new e,h.selectbox.version="0.2"}(jQuery);