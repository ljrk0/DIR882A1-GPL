/* svn info: $Revision: 997 $ $Date: 2018-08-03 18:12:24 +0800 (Fri, 03 Aug 2018) $ */
define([],function(){function h(e){var t=$.Deferred(),n=new SOAPSetSetupWizardStatus;return n.Enabled=e,n.Duration=e?"180":"0",(new SOAPAction).sendSOAPAction("SetSetupWizardStatus",n,null).done(function(e){t.resolve()}).fail(function(){t.reject()}),t.promise()}return{WizDeviceInfo:function(){this.opMode="",this.apcSSID="",this.apcPWD="",this.apSSID="",this.apPWD="",this.password="",this.changePassword=!1,this.deviceSettings=null,this.apcSettings=null,this.wifi_datalist=new Array,this.uplink="",this.hasInternet=!1,this.availableOPMode=null,this.wps=!1,this.ianaTimeZone="",this.autoUpgradeSetting=!0},setWizardStatus:h,getWizDeviceInfo:function(t){var n,e=$.Deferred(),i=getOPmode().then(function(e){t.availableOPMode=e.OperationModeList[0].OperationModeInfo.AvailableOPMode}),a=get_wireless("RADIO_2.4GHz").then(function(e){t.apSSID=e.setting.SSID,t.apPWD=e.security.Key,t.wifi_datalist.push(e)}),o=getUplinkInterface().then(function(e){t.uplink=e.UplinkInterface,t.hasInternet=COMM_ToBOOL(e.NetworkLayerStatus)}),S=(n=$.Deferred(),(new SOAPAction).sendSOAPAction("GetDeviceSettings",null,getDeviceSettings).done(function(e){n.resolve(e)}).fail(function(){n.reject()}),n.promise()).then(function(e){t.deviceSettings=e}),r=new SOAPGetAPLanSettingsResponse,s=(new SOAPAction).sendSOAPAction("GetAPLanSettings",null,r).done(function(e){t.DeviceName=e.DeviceName});return $.when(i,a,o,S,s).always(function(){e.resolve(t)}),e.promise()},storeWizDeviceInfo:function(e){var t,n,i=$.Deferred(),a=new SOAPAction;if(0==e.wps){for(var o in RadioIDList){var S=RadioIDList[o];t=createOPmode(S,e.opMode),a.SetMultipleSOAP("SetOperationMode",t,null)}"WirelessAp"!=e.opMode&&(t=createAPCSettings(e.apcSSID,e.apcPWD),a.SetMultipleSOAP("SetAPClientSettings",t,null))}currentDevice.featureSmartConnect_e&&setSmartConnectStatus(a,!0),S="RADIO_2.4GHz";var r,s,l,u,d,c,p,A,P,D,f=RadioIDToBand(S);if(r=f,s=e,l=new SOAPSetWLanRadioSettings,u=getWiFiData(s.wifi_datalist,r),l.RadioID="RADIO_2.4GHz",l.Enabled=!0,l.Mode="802.11bgn",l.SSID=XMLEncode(s.apSSID),l.Coexistence=!0,l.ChannelWidth=0,l.Channel=0,l.SSIDBroadcast=!0,l.SecondaryChannel=u.setting.SecondaryChannel,l.QoS=u.setting.QoS,l.ScheduleName=u.setting.ScheduleName,l.TXPower=u.setting.TXPower,t=l,a.SetMultipleSOAP("SetWLanRadioSettings",t,null),d=e,(c=new SOAPSetWLanRadioSecurity).RadioID="RADIO_2.4GHz",c.Enabled=!0,c.Type="WPAORWPA2-PSK",c.Encryption="TKIPORAES",c.Key=d.apPWD,c.KeyRenewal=3600,n=c,a.SetMultipleSOAP("SetWLanRadioSecurity",n,null),p=a,A=e,P=new SOAPSetDeviceSettings,D=A.deviceSettings,P.DeviceName=D.DeviceName,P.PresentationURL=D.PresentationURL,P.AdminPassword=A.password,P.ChangePassword=!0,P.CAPTCHA=D.CAPTCHA,currentDevice.featureNewTime&&(P.TZLocation=A.ianaTimeZone),p.SetMultipleSOAP("SetDeviceSettings",P,null),currentDevice.featureAutoUpgrade){var g=new SOAPSetEventNotification,O=new SOAPSetFirmwareAutoUpdate;g.Enabled=e.autoUpgradeSetting,g.AutoFirmwareUpgrade=e.autoUpgradeSetting,O.AutoDownload=e.autoUpgradeSetting,O.AutoUpdate=e.autoUpgradeSetting,delete O.TimeToUpdate.TimeHourValue,delete O.TimeToUpdate.TimeMinuteValue,delete O.TimeToUpdate.TimeMidDateValue,a.SetMultipleSOAP("SetEventNotification",g,null),a.SetMultipleSOAP("SetFirmwareAutoUpdate",O,null)}return h(!1).then(function(){return a.SendMultipleSOAPAction("SetMultipleActions")}).done(function(){i.resolve()}).fail(function(){i.reject()}),i.promise()}}});